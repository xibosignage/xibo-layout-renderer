{"version":3,"file":"xibo-layout-renderer.cjs.js","sources":["../node_modules/nanoevents/index.js","../../src/Modules/Platform/Platform.ts","../../src/Types/Layout/Layout.types.ts","../../src/Modules/Generators/Generators.ts","../../src/Types/Region/Region.types.ts","../../src/Types/Media/Media.types.ts","../../src/Modules/Transitions/Transitions.ts","../../src/Modules/Media/VideoMedia.ts","../../src/Modules/Media/AudioMedia.ts","../../src/Modules/Media/Media.ts","../../src/Modules/Region/Region.ts","../../src/Modules/Layout/Layout.ts","../../src/Types/XLR/XLR.types.ts","../../src/xibo-layout-renderer.ts"],"sourcesContent":["export let createNanoEvents = () => ({\n  emit(event, ...args) {\n    for (\n      let i = 0,\n        callbacks = this.events[event] || [],\n        length = callbacks.length;\n      i < length;\n      i++\n    ) {\n      callbacks[i](...args)\n    }\n  },\n  events: {},\n  on(event, cb) {\n    ;(this.events[event] ||= []).push(cb)\n    return () => {\n      this.events[event] = this.events[event]?.filter(i => cb !== i)\n    }\n  }\n})\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport {OptionsType} from \"../../Types/Layout\";\r\n\r\nconst RESOURCE_URL = '/playlist/widget/resource/:regionId/:id';\r\nconst XLF_URL = '/layout/xlf/:layoutId';\r\nconst LAYOUT_BACKGROUND_DOWNLOAD_URL = '/layout/background/:id';\r\nconst LAYOUT_PREVIEW_URL = '/layout/preview/[layoutCode]';\r\nconst LIBRARY_DOWNLOAD_URL = '/library/download/:id';\r\nconst LOADER_URL = '/theme/default/img/loader.gif';\r\n\r\nexport const platform: OptionsType = {\r\n    getResourceUrl: RESOURCE_URL,\r\n    xlfUrl: XLF_URL,\r\n    layoutBackgroundDownloadUrl: LAYOUT_BACKGROUND_DOWNLOAD_URL,\r\n    layoutPreviewUrl: LAYOUT_PREVIEW_URL,\r\n    libraryDownloadUrl: LIBRARY_DOWNLOAD_URL,\r\n    loaderUrl: LOADER_URL,\r\n    idCounter: 0,\r\n    inPreview: true,\r\n    appHost: null,\r\n    platform: 'CMS',\r\n};\r\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport {DefaultEvents, Emitter, Unsubscribe} from \"nanoevents\";\r\nimport {IRegion} from \"../Region\";\r\nimport {platform} from \"../../Modules/Platform\";\r\nimport {ILayoutEvents} from \"../../Modules/Layout\";\r\nimport {IXlr} from \"../XLR\";\r\n\r\nexport type InputLayoutType = {\r\n    layoutId: number | null;\r\n    path?: string;\r\n};\r\n\r\nexport type OptionsType = {\r\n    xlfUrl: string;\r\n    getResourceUrl: string;\r\n    layoutBackgroundDownloadUrl: string;\r\n    layoutPreviewUrl: string;\r\n    libraryDownloadUrl: string;\r\n    loaderUrl: string;\r\n    idCounter: number;\r\n    inPreview: boolean;\r\n    appHost?: string | null;\r\n    platform: 'CMS' | 'chromeOS';\r\n    config?: {\r\n        cmsUrl: string | null;\r\n        schemaVersion: number;\r\n        cmsKey: string | null;\r\n        hardwareKey: string | null;\r\n    };\r\n};\r\n\r\nexport interface ILayout {\r\n    id: number | null;\r\n    layoutId: number | null;\r\n    sw: number | null;\r\n    sh: number | null;\r\n    xw: number | null;\r\n    xh: number | null;\r\n    zIndex: number | null;\r\n    scaleFactor: number;\r\n    sWidth: number;\r\n    sHeight: number;\r\n    offsetX: number;\r\n    offsetY: number;\r\n    bgColor: string;\r\n    bgImage: string;\r\n    bgId: string;\r\n    containerName: string;\r\n    layoutNode: Document | null;\r\n    regionMaxZIndex: number;\r\n    ready: boolean;\r\n    regionObjects: IRegion[];\r\n    drawer: String[];\r\n    allExpired: boolean;\r\n    regions: IRegion[];\r\n    actions: String[];\r\n    options: OptionsType;\r\n    done: boolean;\r\n    allEnded: boolean;\r\n    path?: string;\r\n    prepareLayout(): void;\r\n    parseXlf(): void;\r\n    run(): void;\r\n    emitter?: Emitter<DefaultEvents>;\r\n    on<E extends keyof ILayoutEvents>(event: E, callback: ILayoutEvents[E]): Unsubscribe;\r\n    regionExpired(): void;\r\n    end(): void;\r\n    regionEnded(): void;\r\n    stopAllMedia(): Promise<void>;\r\n}\r\n\r\nexport const initialLayout: ILayout = {\r\n    id: null,\r\n    layoutId: null,\r\n    sw: 0,\r\n    sh: 0,\r\n    xw: 0,\r\n    xh: 0,\r\n    zIndex: 0,\r\n    scaleFactor: 1,\r\n    sWidth: 0,\r\n    sHeight: 0,\r\n    offsetX: 0,\r\n    offsetY: 0,\r\n    bgColor: '',\r\n    bgImage: '',\r\n    bgId: '',\r\n    containerName: '',\r\n    layoutNode: null,\r\n    regionMaxZIndex: 0,\r\n    ready: false,\r\n    regionObjects: [],\r\n    drawer: [],\r\n    allExpired: false,\r\n    regions: [],\r\n    actions: [],\r\n    options: platform,\r\n    done: false,\r\n    allEnded: false,\r\n    path: '',\r\n    prepareLayout() {\r\n    },\r\n    parseXlf() {\r\n    },\r\n    run() {\r\n    },\r\n    on<E extends keyof ILayoutEvents>(event: E, callback: ILayoutEvents[E]): Unsubscribe {\r\n        return <Unsubscribe>{};\r\n    },\r\n    regionExpired() {\r\n    },\r\n    end() {\r\n    },\r\n    regionEnded() {\r\n    },\r\n    stopAllMedia() {\r\n        return Promise.resolve();\r\n    },\r\n};\r\n\r\nexport type GetLayoutParamType = {\r\n    xlr: IXlr;\r\n    moveNext?: boolean;\r\n}\r\n\r\nexport type GetLayoutType = {\r\n    currentLayoutIndex: number;\r\n    inputLayouts: InputLayoutType[];\r\n    current: ILayout | undefined;\r\n    next: ILayout | undefined;\r\n}\r\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport { IMedia } from '../../Types/Media';\r\nimport {InputLayoutType, OptionsType} from \"../../Types/Layout\";\r\n\r\nexport function nextId(options: { idCounter: number; }) {\r\n    if (options.idCounter > 500) {\r\n        options.idCounter = 0;\r\n    }\r\n\r\n    options.idCounter = options.idCounter + 1;\r\n    return options.idCounter;\r\n}\r\n\r\nexport const getMediaId = ({mediaType, containerName}: IMedia) => {\r\n    let mediaId = containerName;\r\n\r\n    if (mediaType === 'video') {\r\n        mediaId = mediaId + '-vid';\r\n    } else if (mediaType === 'audio') {\r\n        mediaId = mediaId + '-aud';\r\n    }\r\n\r\n    return mediaId;\r\n};\r\n\r\nexport const capitalizeStr = (inputStr: string) => {\r\n    if (inputStr === null) {\r\n        return '';\r\n    }\r\n\r\n    return String(inputStr).charAt(0).toUpperCase() + String(inputStr).substring(1);\r\n};\r\n\r\nexport async function getDataBlob(src: string) {\r\n    return fetch(src, {mode: 'no-cors'})\r\n        .then((res) => res.blob())\r\n        .then((blob) => new Promise((res, rej) => {\r\n            const reader = new FileReader();\r\n\r\n            reader.onloadend = () => res(reader.result);\r\n            reader.onerror = rej;\r\n            reader.readAsDataURL(blob);\r\n        }));\r\n}\r\n\r\nexport async function preloadMediaBlob(src: string, type: 'video' | 'audio' | 'image') {\r\n    const res = await fetch(src, {mode: 'no-cors'});\r\n    let blob: Blob | MediaSource = new Blob();\r\n\r\n    if (type === 'image') {\r\n        blob = new Blob()\r\n    } else if (type === 'video') {\r\n        blob = await res.blob();\r\n    } else if (type === 'audio') {\r\n        const data = await res.arrayBuffer();\r\n        blob = new Blob([data], { type: audioFileType(getFileExt(src)) })\r\n    }\r\n\r\n    console.log({blob})\r\n    return URL.createObjectURL(blob);\r\n}\r\n\r\nexport async function fetchJSON(url: string) {\r\n    return fetch(url)\r\n        .then(res => res.json())\r\n        .catch(err => {\r\n            console.log(err);\r\n        });\r\n}\r\n\r\nexport function getFileExt(filename: string) {\r\n    const filenameArr = String(filename).split('.');\r\n\r\n    return filenameArr[filenameArr.length - 1];\r\n}\r\n\r\nexport function audioFileType(str: string) {\r\n    const validAudioTypes = {\r\n        'mp3': 'audio/mp3',\r\n        'wav': 'audio/wav',\r\n        'ogg': 'audio/ogg',\r\n    };\r\n\r\n    if (Boolean(validAudioTypes[str as 'mp3' | 'wav' | 'ogg'])) {\r\n        return validAudioTypes[str as 'mp3' | 'wav' | 'ogg'];\r\n    }\r\n\r\n    return undefined;\r\n}\r\n\r\nexport function composeResourceUrlByPlatform(platform: OptionsType['platform'], params: any) {\r\n    let resourceUrl = params.regionOptions.getResourceUrl\r\n        .replace(\":regionId\", params.regionId)\r\n        .replace(\":id\", params.mediaId) +\r\n        '?preview=1&layoutPreview=1';\r\n\r\n    if (platform === 'chromeOS') {\r\n        resourceUrl = params.cmsUrl +\r\n            '/chromeOS/resource/' +\r\n            params.fileId +\r\n            '?saveAs=' + params.uri;\r\n    } else if (!Boolean(params['mediaType'])) {\r\n        resourceUrl += '&scale_override=' + params.scaleFactor;\r\n    }\r\n\r\n    return resourceUrl;\r\n}\r\n\r\ntype LayoutIndexType = {\r\n    [k: string]: InputLayoutType & {\r\n        index: number;\r\n    }\r\n}\r\n\r\nexport function getIndexByLayoutId(layoutsInput: InputLayoutType[], layoutId?: number | null) {\r\n    let layoutIndexes = layoutsInput.reduce((a: LayoutIndexType, b, indx) => {\r\n        a[Number(b.layoutId)] = {\r\n            ...b,\r\n            index: indx\r\n        };\r\n\r\n        return a;\r\n    }, {});\r\n\r\n    if (layoutId === null || !layoutId) {\r\n        return layoutIndexes;\r\n    }\r\n\r\n    return layoutIndexes[layoutId];\r\n}\r\n\r\nexport function isEmpty(input: any) {\r\n    return !Boolean(input) || String(input).length === 0;\r\n}\r\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport { DefaultEvents, Emitter, Unsubscribe } from \"nanoevents\";\r\nimport {ILayout, initialLayout, OptionsType} from \"../Layout/Layout.types\";\r\nimport {platform} from \"../../Modules/Platform/Platform\";\r\nimport {IMedia} from \"../Media/Media.types\";\r\n\r\nexport interface IRegionEvents {\r\n    start: (layout: IRegion) => void;\r\n    end: (layout: IRegion) => void;\r\n}\r\n\r\nexport interface IRegion {\r\n    layout: ILayout;\r\n    id: string;\r\n    regionId: string;\r\n    xml: null | Element;\r\n    mediaObjects: IMedia[];\r\n    mediaObjectsActions: String[];\r\n    currentMedia: number;\r\n    complete: boolean;\r\n    containerName: string;\r\n    ending: boolean;\r\n    ended: boolean;\r\n    oneMedia: boolean;\r\n    oldMedia: IMedia | undefined;\r\n    curMedia: IMedia | undefined;\r\n    nxtMedia: IMedia | undefined;\r\n    currentMediaIndex: number;\r\n    totalMediaObjects: number;\r\n    ready: boolean;\r\n    options: {\r\n        [k: string]: any;\r\n    };\r\n    sWidth: number;\r\n    sHeight: number;\r\n    offsetX: number;\r\n    offsetY: number;\r\n    zIndex: number;\r\n    index: number;\r\n    emitter?: Emitter<DefaultEvents>;\r\n    prepareRegion(): void;\r\n    playNextMedia(): void;\r\n    transitionNodes(oldMedia: IMedia | undefined, newMedia: IMedia | undefined): void;\r\n    finished(): void;\r\n    run(): void;\r\n    end(): void;\r\n    exitTransition(): void;\r\n    exitTransitionComplete(): void;\r\n    on<E extends keyof IRegionEvents>(event: E, callback: IRegionEvents[E]): Unsubscribe;\r\n    prepareMediaObjects(): void;\r\n}\r\n\r\nexport const initialRegion: IRegion = {\r\n    layout: initialLayout,\r\n    id: '',\r\n    regionId: '',\r\n    xml: null,\r\n    mediaObjects: [],\r\n    mediaObjectsActions: [],\r\n    currentMedia: -1,\r\n    complete: false,\r\n    containerName: '',\r\n    ending: false,\r\n    ended: false,\r\n    oneMedia: false,\r\n    oldMedia: undefined,\r\n    curMedia: undefined,\r\n    nxtMedia: undefined,\r\n    currentMediaIndex: 0,\r\n    totalMediaObjects: 0,\r\n    ready: false,\r\n    options: {},\r\n    sWidth: 0,\r\n    sHeight: 0,\r\n    offsetX: 0,\r\n    offsetY: 0,\r\n    zIndex: 0,\r\n    index: -1,\r\n    prepareRegion() {\r\n    },\r\n    playNextMedia() {\r\n    },\r\n    transitionNodes() {\r\n    },\r\n    finished() {\r\n    },\r\n    run() {\r\n    },\r\n    end() {\r\n    },\r\n    exitTransition() {},\r\n    exitTransitionComplete() {},\r\n    on<E extends keyof IRegionEvents>(event: E, callback: IRegionEvents[E]): Unsubscribe {\r\n        return <Unsubscribe>{};\r\n    },\r\n    prepareMediaObjects() {\r\n    },\r\n};\r\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport { DefaultEvents, Emitter, Unsubscribe } from \"nanoevents\";\r\nimport { IMediaEvents } from \"../../Modules/Media/Media\";\r\nimport {initialRegion, IRegion} from \"../Region/Region.types\";\r\n\r\nexport interface IMedia {\r\n    region: IRegion;\r\n    xml: null | Element;\r\n    id: string;\r\n    idCounter: number;\r\n    index: number;\r\n    containerName: string;\r\n    html: null | HTMLElement;\r\n    iframe: null | HTMLIFrameElement;\r\n    iframeName: string;\r\n    mediaType: string;\r\n    render: string;\r\n    attachedAudio: boolean;\r\n    singlePlay: boolean;\r\n    timeoutId: ReturnType<typeof setTimeout>;\r\n    ready: boolean;\r\n    checkIframeStatus: boolean;\r\n    loadIframeOnRun: boolean;\r\n    tempSrc: string;\r\n    finished: boolean;\r\n    schemaVersion: string;\r\n    type: string;\r\n    duration: number;\r\n    useDuration: boolean;\r\n    fileId: string;\r\n    uri: string;\r\n    options: {\r\n        [k: string]: any;\r\n    };\r\n    divWidth: number;\r\n    divHeight: number;\r\n    url: string | null;\r\n    loop: boolean;\r\n    emitter?: Emitter<DefaultEvents>;\r\n    run(): void;\r\n    init(): void;\r\n    stop(): Promise<void>;\r\n    on<E extends keyof IMediaEvents>(event: E, callback: IMediaEvents[E]): Unsubscribe;\r\n}\r\n\r\nexport const initialMedia: IMedia = {\r\n    region: initialRegion,\r\n    xml: null,\r\n    id: '',\r\n    index: 0,\r\n    idCounter: 0,\r\n    containerName: '',\r\n    html: null,\r\n    iframe: null,\r\n    iframeName: '',\r\n    mediaType: '',\r\n    render: 'html',\r\n    attachedAudio: false,\r\n    singlePlay: false,\r\n    timeoutId: setTimeout(() => {}, 100),\r\n    ready: true,\r\n    checkIframeStatus: false,\r\n    loadIframeOnRun: false,\r\n    tempSrc: '',\r\n    finished: false,\r\n    schemaVersion: '1',\r\n    type: '',\r\n    duration: 0,\r\n    useDuration: Boolean(0),\r\n    fileId: '',\r\n    uri: '',\r\n    options: {},\r\n    divWidth: 0,\r\n    divHeight: 0,\r\n    url: null,\r\n    loop: false,\r\n    run() {},\r\n    init() {},\r\n    stop() {\r\n        return Promise.resolve();\r\n    },\r\n    on<E extends keyof IMediaEvents>(event: E, callback: IMediaEvents[E]): Unsubscribe {\r\n        return <Unsubscribe>{};\r\n    },\r\n}\r\n","/*\n * Copyright (C) 2024 Xibo Signage Ltd\n *\n * Xibo - Digital Signage - https://www.xibosignage.com\n *\n * This file is part of Xibo.\n *\n * Xibo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n *\n * Xibo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\n */\nexport const defaultTrans = (duration: number, trans: 'in' | 'out') => {\n    const defaultKeyframes = [\n        { display: trans === 'in' ? 'none' : 'block' },\n        { display: trans === 'out' ? 'none' : 'block' },\n    ];\n    const defaultTiming: number | KeyframeAnimationOptions | undefined = {\n        duration,\n    };\n\n    return {\n        keyframes: defaultKeyframes,\n        timing: defaultTiming,\n    };\n};\n\nexport const fadeInElem = (duration: number) => {\n    const fadeInKeyframes = [\n        { opacity: 0 },\n        { opacity: 1 },\n    ];\n    const fadeInTiming: number | KeyframeAnimationOptions | undefined = {\n        duration,\n        fill: 'forwards',\n    };\n\n    return {\n        keyframes: fadeInKeyframes,\n        timing: fadeInTiming,\n    }\n};\n\nexport const fadeOutElem = (duration: number) => {\n    const fadeOutKeyframes = [\n        { opacity: 1 },\n        { opacity: 0, zIndex: -1 },\n    ];\n    const fadeOutTiming: number | KeyframeAnimationOptions | undefined = {\n        duration,\n        fill: 'forwards',\n    };\n\n    return {\n        keyframes: fadeOutKeyframes,\n        timing: fadeOutTiming,\n    }\n};\n\nexport type KeyframeOptionsType = {\n    from: {\n        [k: string]: any,\n    },\n    to: {\n        [k: string]: any,\n    },\n}\n\nexport const flyInElem = (duration: number, keyframeOptions: KeyframeOptionsType | undefined, direction?: string) => {\n    const flyInKeyframes = [\n        {opacity: 0},\n        {opacity: 1, zIndex: 1},\n    ];\n    const flyInTiming: number | KeyframeAnimationOptions | undefined = {\n        duration,\n        fill: 'forwards',\n    };\n\n    if (keyframeOptions && Boolean(keyframeOptions.from)) {\n        flyInKeyframes[0] = {...keyframeOptions.from, ...flyInKeyframes[0]};\n    }\n\n    if (keyframeOptions && Boolean(keyframeOptions.to)) {\n        flyInKeyframes[1] = {...keyframeOptions.to, ...flyInKeyframes[1]};\n    }\n\n    return {\n        keyframes: flyInKeyframes,\n        timing: flyInTiming,\n    };\n};\n\nexport const flyOutElem = (duration: number, keyframeOptions: KeyframeOptionsType | undefined, direction?: string) => {\n    const flyOutKeyframes: Keyframe[] = [\n        {opacity: 1},\n        {opacity: 0, zIndex: -1},\n    ];\n    const flyOutTiming: number | KeyframeAnimationOptions | undefined = {\n        duration,\n        fill: 'forwards',\n    };\n\n    if (keyframeOptions && Boolean(keyframeOptions.from)) {\n        flyOutKeyframes[0] = {...keyframeOptions.from, ...flyOutKeyframes[0]};\n    }\n\n    if (keyframeOptions && Boolean(keyframeOptions.to)) {\n        flyOutKeyframes[1] = {...keyframeOptions.to, ...flyOutKeyframes[1]};\n    }\n\n    return {\n        keyframes: flyOutKeyframes,\n        timing: flyOutTiming,\n    };\n};\n\nexport type TransitionNameType = 'fadeIn' | 'fadeOut' | 'flyIn' | 'flyOut' | 'defaultIn' | 'defaultOut';\n\nexport type TransitionElementOptions = {\n    duration: number;\n    keyframes?: KeyframeOptionsType;\n    direction?: string;\n};\n\nexport const transitionElement = (transition: TransitionNameType, options: TransitionElementOptions) => {\n    const transitions = {\n        fadeIn: fadeInElem(options.duration),\n        fadeOut: fadeOutElem(options.duration),\n        flyIn: flyInElem(options.duration, options.keyframes, options.direction),\n        flyOut: flyOutElem(options.duration, options.keyframes, options.direction),\n        defaultIn: defaultTrans(options.duration, 'in'),\n        defaultOut: defaultTrans(options.duration, 'out'),\n    };\n\n    return transitions[transition];\n};\n\nexport type compassPoints = 'N' | 'NE' | 'E' | 'SE' | 'S' | 'SW' | 'W' | 'NW';\n\nexport type flyTransitionParams = {\n    trans: 'in' | 'out';\n    direction: compassPoints;\n    height: string | number;\n    width: string | number;\n};\n\nexport const flyTransitionKeyframes = (params: flyTransitionParams): KeyframeOptionsType => {\n    const keyframes = {\n        from: {},\n        to: {},\n    };\n    const opacityAttr = (source: 'from' | 'to') => {\n        if (source === 'from') {\n            return params.trans === 'in' ? 0 : 1;\n        }\n        \n        return params.trans === 'out' ? 1 : 0;\n    };\n\n    switch (params.direction) {\n        case 'N':\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                top: params.trans === 'in' ? `${params.height}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                top: params.trans === 'in' ? 0 : `-${params.height}px`,\n            };\n            break;\n        case 'NE':\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                top: params.trans === 'in' ? `${params.height}px` : 0,\n                left: params.trans === 'in' ? `-${params.width}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                top: params.trans === 'in' ? 0 : `-${params.height}px`,\n                left: params.trans === 'in' ? 0 : `${params.width}px`,\n            };\n            break;\n        case 'E':\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                left: params.trans === 'in' ? `-${params.width}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                left: params.trans === 'in' ? 0 : `${params.width}px`,\n            };\n            break;\n        case 'SE':\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                top: params.trans === 'in' ? `-${params.height}px` : 0,\n                left: params.trans === 'in' ? `-${params.width}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                top: params.trans === 'in' ? 0 : `${params.height}px`,\n                left: params.trans === 'in' ? 0 : `${params.width}px`,\n            };\n            break;\n        case 'S':\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                top: params.trans === 'in' ? `-${params.height}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                top: params.trans === 'in' ? 0 : `${params.height}px`,\n            };\n            break;\n        case 'SW':\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                top: params.trans === 'in' ? `-${params.height}px` : 0,\n                left: params.trans === 'in' ? `${params.width}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                top: params.trans === 'in' ? 0 : `${params.height}px`,\n                left: params.trans === 'in' ? 0 : `-${params.width}px`,\n            };\n            break;\n        case 'W':\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                left: params.trans === 'in' ? `${params.width}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                left: params.trans === 'in' ? 0 : `-${params.width}px`,\n            };\n            break;\n        case 'NW':\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                top: params.trans === 'in' ? `${params.height}px` : 0,\n                left: params.trans === 'in' ? `${params.width}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                top: params.trans === 'in' ? 0 : `-${params.height}px`,\n                left: params.trans === 'in' ? 0 : `-${params.width}px`,\n            };\n            break;\n        default:\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                top: params.trans === 'in' ? `${params.height}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                top: params.trans === 'in' ? 0 : `-${params.height}px`,\n            };\n            break;\n    }\n\n    return keyframes;\n};\n","/*\n * Copyright (C) 2024 Xibo Signage Ltd\n *\n * Xibo - Digital Signage - https://www.xibosignage.com\n *\n * This file is part of Xibo.\n *\n * Xibo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n *\n * Xibo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\n */\nimport { IMedia } from '../../Types/Media';\nimport { capitalizeStr, getMediaId } from '../Generators';\n\nexport default function VideoMedia(media: IMedia) {\n    const videoMediaObject = {\n        init() {\n            const $videoMedia = document.getElementById(getMediaId(media)) as HTMLVideoElement;\n\n            if ($videoMedia) {\n                $videoMedia.onloadstart = () => {\n                    console.log(`${capitalizeStr(media.mediaType)} for media > ${media.id} has started loading data . . .`);\n                };\n                $videoMedia.onloadeddata = () => {\n                    if ($videoMedia.readyState >= 2) {\n                        console.log(`${capitalizeStr(media.mediaType)} data for media > ${media.id} has been fully loaded . . .`);\n                    }\n                };\n                $videoMedia.oncanplay = () => {\n                    console.log(`${capitalizeStr(media.mediaType)} for media > ${media.id} can be played . . .`);\n        \n                    const videoPlayPromise = $videoMedia.play();\n        \n                    if (videoPlayPromise !== undefined) {\n                        videoPlayPromise.then(() => {\n                            console.log('autoplay started . . .');\n                            // Autoplay restarted\n                        }).catch(error => {\n                            $videoMedia.muted = true;\n                            $videoMedia.play();\n                        });\n                    }\n                };\n                $videoMedia.onplaying = () => {\n                    console.log(`${capitalizeStr(media.mediaType)} for media > ${media.id} is now playing . . .`);\n                };\n\n                if (media.duration === 0) {\n                    $videoMedia.ondurationchange = () => {\n                        console.log('Showing Media ' + media.id + ' for ' + $videoMedia.duration + 's of Region ' + media.region.regionId);\n                    };\n                    $videoMedia.onended = () => {\n                        console.log(`${capitalizeStr(media.mediaType)} for media > ${media.id} has ended playing . . .`);\n                        media.emitter?.emit('end', media);\n                    };\n                }\n            }\n        }\n    }\n\n    return videoMediaObject;\n}\n","/*\n * Copyright (C) 2024 Xibo Signage Ltd\n *\n * Xibo - Digital Signage - https://www.xibosignage.com\n *\n * This file is part of Xibo.\n *\n * Xibo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n *\n * Xibo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\n */\nimport { IMedia } from '../../Types/Media';\nimport { capitalizeStr, getMediaId } from '../Generators';\n\nimport './media.css';\n\nexport default function AudioMedia(media: IMedia) {\n    const audioMediaObject = {\n        init() {\n            const $audioMedia = document.getElementById(getMediaId(media)) as HTMLAudioElement;\n            let $playBtn: HTMLButtonElement | null = null;\n\n            if ($audioMedia) {\n                $audioMedia.onloadstart = () => {\n                    console.log(`${capitalizeStr(media.mediaType)} for media > ${media.id} has started loading data . . .`);\n                };\n                $audioMedia.onloadeddata = () => {\n                    if ($audioMedia.readyState >= 2) {\n                        console.log(`${capitalizeStr(media.mediaType)} data for media > ${media.id} has been fully loaded . . .`);\n                    }\n                };\n                $audioMedia.oncanplay = () => {\n                    console.log(`${capitalizeStr(media.mediaType)} for media > ${media.id} can be played . . .`);\n                };\n                $audioMedia.onplaying = () => {\n                    console.log(`${capitalizeStr(media.mediaType)} for media > ${media.id} is now playing . . .`);\n\n                    if ($playBtn !== null) {\n                        $playBtn.remove();\n                    }\n                };\n\n                const audioPlayPromise = $audioMedia.play();\n    \n                if (audioPlayPromise !== undefined) {\n                    audioPlayPromise.then(() => {\n                        console.log('autoplay started . . .');\n                        // Autoplay restarted\n                    }).catch(error => {\n                        if (error.name === 'NotAllowedError') {\n                            // Let's show a play audio button\n                            $playBtn = document.createElement('button');\n\n                            $playBtn.classList.add('play-audio-btn');\n                            $playBtn.textContent = 'Play Audio';\n                            $playBtn.addEventListener('click', () => {\n                                $audioMedia.muted = false;\n                                $audioMedia.play();\n                            });\n                            $audioMedia.parentNode?.insertBefore($playBtn, $audioMedia.nextSibling);\n                        }\n                    });\n                }\n                if (media.duration === 0) {\n                    $audioMedia.ondurationchange = () => {\n                        console.log('Showing Media ' + media.id + ' for ' + $audioMedia.duration + 's of Region ' + media.region.regionId);\n                    };\n                    $audioMedia.onended = () => {\n                        console.log(`${capitalizeStr(media.mediaType)} for media > ${media.id} has ended playing . . .`);\n                        media.emitter?.emit('end', media);\n                    };\n                }\n            }\n        },\n    };\n\n    return audioMediaObject;\n}\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport { createNanoEvents } from \"nanoevents\";\r\nimport { OptionsType } from '../../Types/Layout';\r\nimport { IRegion } from '../../Types/Region';\r\nimport { IMedia, initialMedia } from '../../Types/Media';\r\nimport { fetchJSON, getMediaId, nextId, preloadMediaBlob } from '../Generators';\r\nimport { TransitionElementOptions, compassPoints, flyTransitionKeyframes, transitionElement } from '../Transitions';\r\nimport VideoMedia from './VideoMedia';\r\nimport AudioMedia from './AudioMedia';\r\nimport {composeResourceUrlByPlatform, getDataBlob} from \"../Generators/Generators\";\r\nimport {IXlr} from \"../../Types/XLR\";\r\n\r\nexport interface IMediaEvents {\r\n    start: (media: IMedia) => void;\r\n    end: (media: IMedia) => void;\r\n}\r\n\r\nexport default function Media(\r\n    region: IRegion,\r\n    mediaId: string,\r\n    xml: Element,\r\n    options: OptionsType,\r\n    xlr: IXlr,\r\n) {\r\n    const props = {\r\n        region: region,\r\n        mediaId: mediaId,\r\n        xml: xml,\r\n        options: options,\r\n    };\r\n    let mediaTimer: string | number | NodeJS.Timeout | null | undefined = null;\r\n    let mediaTimeCount = 0;\r\n    const emitter = createNanoEvents<IMediaEvents>();\r\n    const mediaObject: IMedia = {\r\n        ...initialMedia,\r\n        ...props,\r\n    };\r\n    const startMediaTimer = (media: IMedia) => {\r\n        mediaTimer = setInterval(() => {\r\n            mediaTimeCount++;\r\n            if (mediaTimeCount > media.duration) {\r\n                media.emitter?.emit('end', media);\r\n            }\r\n        }, 1000);\r\n        console.log('Showing Media ' + media.id + ' for ' + media.duration + 's of Region ' + media.region.regionId);\r\n    };\r\n\r\n    emitter.on('start', function(media) {\r\n        if (media.mediaType === 'video') {\r\n            VideoMedia(media).init();\r\n\r\n            if (media.duration > 0) {\r\n                startMediaTimer(media);\r\n            }\r\n        } else if (media.mediaType === 'audio') {\r\n            AudioMedia(media).init();\r\n            if (media.duration > 0) {\r\n                startMediaTimer(media);\r\n            }\r\n        } else {\r\n            startMediaTimer(media);\r\n        }\r\n    });\r\n\r\n    emitter.on('end', function(media) {\r\n        if (mediaTimer) {\r\n            clearInterval(mediaTimer);\r\n            mediaTimeCount = 0;\r\n        }\r\n\r\n        media.region.playNextMedia();\r\n    });\r\n\r\n    mediaObject.init = function() {\r\n        const self = mediaObject;\r\n        self.id = props.mediaId;\r\n        self.fileId = self.xml?.getAttribute('fileId') || '';\r\n        self.idCounter = nextId(props.options);\r\n        self.containerName = `M-${self.id}-${self.idCounter}`;\r\n        self.iframeName = `${self.containerName}-iframe`;\r\n        self.mediaType = self.xml?.getAttribute('type') || '';\r\n        self.render = self.xml?.getAttribute('render') || '';\r\n        self.duration = parseInt(self.xml?.getAttribute('duration') as string) || 0;\r\n        self.options = { ...props.options, mediaId };\r\n\r\n        const $mediaIframe = document.createElement('iframe');\r\n        const mediaOptions = self.xml?.getElementsByTagName('options');\r\n\r\n        if (mediaOptions) {\r\n            for (let _options of Array.from(mediaOptions)) {\r\n                // Get options\r\n                const _mediaOptions = _options.children;\r\n                for (let mediaOption of Array.from(_mediaOptions)) {\r\n                    self.options[mediaOption.nodeName.toLowerCase()] = mediaOption.textContent;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check for options.uri and add it to media\r\n        if (Boolean(self.options['uri'])) {\r\n            self.uri = self.options['uri'];\r\n        }\r\n\r\n        // Show in fullscreen?\r\n        if(self.options.showfullscreen === \"1\") {\r\n            // Set dimensions as the layout ones\r\n            self.divWidth = self.region.layout.sWidth;\r\n            self.divHeight = self.region.layout.sHeight;\r\n        } else {\r\n            // Set dimensions as the region ones\r\n            self.divWidth = self.region.sWidth;\r\n            self.divHeight = self.region.sHeight;\r\n        }\r\n\r\n        $mediaIframe.scrolling = 'no';\r\n        $mediaIframe.id = self.iframeName;\r\n        $mediaIframe.width = `${self.divWidth}px`;\r\n        $mediaIframe.height = `${self.divHeight}px`;\r\n        $mediaIframe.style.cssText = `border: 0; visibility: hidden;`;\r\n\r\n        const $mediaId = getMediaId(self);\r\n        let $media = document.getElementById($mediaId);\r\n\r\n        if ($media === null) {\r\n            if (self.mediaType === 'video') {\r\n                $media = document.createElement('video');\r\n            } else if (self.mediaType === 'audio') {\r\n                $media = new Audio();\r\n            } else {\r\n                $media = document.createElement('div');\r\n            }\r\n        \r\n            $media.id = $mediaId;\r\n        }\r\n\r\n        $media.className = 'media--item';\r\n\r\n        /* Scale the Content Container */\r\n        $media.style.cssText = `\r\n            display: none;\r\n            width: ${self.divWidth}px;\r\n            height: ${self.divHeight}px;\r\n            position: absolute;\r\n            background-size: contain;\r\n            background-repeat: no-repeat;\r\n            background-position: center;\r\n        `;\r\n\r\n        const $region = document.getElementById(`${self.region.containerName}`);\r\n\r\n        const resourceUrlParams: any = {\r\n            ...xlr.config.config,\r\n            regionOptions: self.region.options,\r\n            layoutId: self.region.layout.layoutId,\r\n            regionId: self.region.id,\r\n            mediaId: self.id,\r\n            fileId: self.fileId,\r\n            scaleFactor: self.region.layout.scaleFactor,\r\n            uri: self.uri,\r\n        };\r\n\r\n        if (self.mediaType === 'image' || self.mediaType === 'video') {\r\n            resourceUrlParams.mediaType = self.mediaType;\r\n        }\r\n\r\n        const tmpUrl = composeResourceUrlByPlatform(xlr.config.platform, resourceUrlParams);\r\n\r\n        self.url = tmpUrl;\r\n\r\n        // Loop if media has loop, or if region has loop and a single media\r\n        self.loop =\r\n            self.options['loop'] == '1' ||\r\n            (self.region.options['loop'] == '1' && self.region.totalMediaObjects == 1);\r\n\r\n        $mediaIframe.src = `${tmpUrl}&width=${self.divWidth}&height=${self.divHeight}`;\r\n\r\n        if (self.render === 'html' || self.mediaType === 'ticker') {\r\n            self.checkIframeStatus = true;\r\n            self.iframe = $mediaIframe;\r\n        }  else if (self.mediaType === \"image\") {\r\n            // preload.addFiles(tmpUrl);\r\n            // $media.style.cssText = $media.style.cssText.concat(`background-image: url('${tmpUrl}');`);\r\n            if (self.options['scaletype'] === 'stretch') {\r\n                $media.style.cssText = $media.style.cssText.concat(`background-size: 100% 100%;`);\r\n            } else if (self.options['scaletype'] === 'fit') {\r\n                $media.style.cssText = $media.style.cssText.concat(`background-size: cover;`);\r\n            } else {\r\n                // Center scale type, do we have align or valign?\r\n                const align = (self.options['align'] == \"\") ? \"center\" : self.options['align'];\r\n                const valign = (self.options['valign'] == \"\" || self.options['valign'] == \"middle\") ? \"center\" : self.options['valign'];\r\n                $media.style.cssText = $media.style.cssText.concat(`background-position: ${align} ${valign}`);\r\n            }\r\n        } else if (self.mediaType === 'video') {\r\n            const $videoMedia = $media as HTMLVideoElement;\r\n\r\n            $videoMedia.preload = 'auto';\r\n            $videoMedia.textContent = 'Unsupported Video';\r\n\r\n            if (Boolean(self.options['mute'])) {\r\n                $videoMedia.muted = self.options.mute === '1';\r\n            }\r\n\r\n            if (Boolean(self.options['scaletype'])) {\r\n                if (self.options.scaletype === 'stretch') {\r\n                    $videoMedia.style.objectFit = 'fill';\r\n                }\r\n            }\r\n            $videoMedia.playsInline = true;\r\n\r\n            if (self.loop) {\r\n                $videoMedia.loop = true;\r\n            }\r\n\r\n            $media = $videoMedia;\r\n        } else if (self.mediaType === 'audio') {\r\n            const $audioMedia = $media as HTMLAudioElement;\r\n\r\n            $audioMedia.preload = 'auto';\r\n            $audioMedia.textContent = 'Unsupported Audio';\r\n            $audioMedia.autoplay = true;\r\n\r\n            if (self.loop) {\r\n                $audioMedia.loop = true;\r\n            }\r\n\r\n            $media = $audioMedia;\r\n        }\r\n\r\n        // Duration is per item condition\r\n        if (self.render === 'html' || self.mediaType === 'ticker') {\r\n            /* Check if the ticker duration is based on the number of items in the feed */\r\n            if (self.options['durationisperitem'] === '1') {\r\n                const regex = new RegExp('<!-- NUMITEMS=(.*?) -->');\r\n\r\n                (async () => {\r\n                    let html = await fetchJSON(`${tmpUrl}&width=${self.divWidth}&height=${self.divHeight}`);\r\n                    console.log({html});\r\n                    const res = regex.exec(html);\r\n\r\n                    if (res !== null) {\r\n                        self.duration = parseInt(String(self.duration)) * parseInt(res[1]);\r\n                    }\r\n                })();\r\n            }\r\n        }\r\n\r\n        // Check if the media has fade-in/out transitions\r\n        if (Boolean(self.options['transin']) && Boolean(self.options['transinduration'])) {\r\n            const transInDuration = Number(self.options.transinduration);\r\n            const fadeInTrans = transitionElement('fadeIn', { duration: transInDuration });\r\n            $media.animate(fadeInTrans.keyframes, fadeInTrans.timing);\r\n        }\r\n\r\n        // Add media to the region\r\n        // Second media if exists, will be off-canvas\r\n        // All added media will be hidden by default\r\n        // It will start showing when region.nextMedia() function is called\r\n\r\n        // When there's only 1 item and loop = false, don't remove the item but leave it at its last state\r\n        // For image, and only 1 item, it should still have the transition for next state\r\n        // Add conditions for video duration being 0 or 1 and also the loop property\r\n        // For video url, we have to create a URL out of the XLF video URL\r\n\r\n        /**\r\n         * @DONE\r\n         * Case 1: Video duration = 0, this will play the video for its entire duration\r\n         * Case 2: Video duration is set > 0 and loop = false\r\n         * E.g. Set duration = 100s, video duration = 62s\r\n         * the video will play until 62s and will stop to its last frame until 100s\r\n         * After 100s, it will expire\r\n         * Case 3: Video duration is set > 0 and loop = true\r\n         * E.g. Set duration = 100s, video duration = 62s, loop = true\r\n         * the video will play until 62s and will loop through until the remaining 38s\r\n         * to complete the 100s set duration\r\n         */\r\n\r\n        // Add html node to media for \r\n\r\n        self.html = $media;\r\n\r\n        // Check/set iframe based widgets play status\r\n        // if(self.iframe && self.checkIframeStatus) {\r\n        //     // Set state as false ( for now )\r\n        //     self.ready = false;\r\n        //\r\n        //     // Append iframe\r\n        //     $media.innerHTML = '';\r\n        //     $media.appendChild(self.iframe as Node);\r\n        //\r\n        //     // On iframe load, set state as ready to play full preview\r\n        //     (self.iframe) && self.iframe.addEventListener('load', function(){\r\n        //         self.ready = true;\r\n        //         if (self.iframe) {\r\n        //             const iframeStyles = self.iframe.style.cssText;\r\n        //             self.iframe.style.cssText = iframeStyles?.concat('visibility: visible;');\r\n        //         }\r\n        //     });\r\n        // }\r\n\r\n    };\r\n\r\n    mediaObject.run = function() {\r\n        const self = mediaObject;\r\n        let transInDuration = 1;\r\n        let transInDirection: compassPoints = 'E';\r\n\r\n        if (Boolean(self.options['transinduration'])) {\r\n            transInDuration = Number(self.options.transinduration);\r\n        }\r\n\r\n        if (Boolean(self.options['transindirection'])) {\r\n            transInDirection = self.options.transindirection;\r\n        }\r\n\r\n        let defaultTransInOptions: TransitionElementOptions = {duration: transInDuration};\r\n        let transIn = transitionElement('defaultIn', {duration: defaultTransInOptions.duration});\r\n        \r\n        if (Boolean(self.options['transin'])) {\r\n            let transInName = self.options['transin'];\r\n\r\n            if (transInName === 'fly') {\r\n                transInName = `${transInName}In`;\r\n                defaultTransInOptions.keyframes = flyTransitionKeyframes({\r\n                    trans: 'in',\r\n                    direction: transInDirection,\r\n                    height: self.divHeight,\r\n                    width: self.divWidth,\r\n                });\r\n            }\r\n\r\n            transIn = transitionElement(transInName, defaultTransInOptions);\r\n        }\r\n\r\n        const showCurrentMedia = async () => {\r\n            let $mediaId = getMediaId(self);\r\n            let $media = document.getElementById($mediaId);\r\n            const isCMS = xlr.config.platform === 'CMS';\r\n\r\n            if ($media === null) {\r\n                $media = getNewMedia();\r\n            }\r\n\r\n            if ($media !== null) {\r\n                $media.style.setProperty('display', 'block');\r\n\r\n                if (Boolean(self.options['transin'])) {\r\n                    $media.animate(transIn.keyframes, transIn.timing);\r\n                }\r\n\r\n                if (self.mediaType === 'image' && self.url !== null) {\r\n                    ($media as HTMLImageElement).style\r\n                        .setProperty(\r\n                            'background-image',\r\n                            `url(${!isCMS ? self.url : await getDataBlob(self.url)}`\r\n                        );\r\n                } else if (self.mediaType === 'video' && self.url !== null) {\r\n                    ($media as HTMLVideoElement).src =\r\n                        isCMS ? await preloadMediaBlob(self.url, self.mediaType) : self.url;\r\n                } else if (self.mediaType === 'audio' && self.url !== null) {\r\n                    ($media as HTMLAudioElement).src =\r\n                        isCMS ? await preloadMediaBlob(self.url, self.mediaType) : self.url;\r\n                } else if (self.render === 'html' && self.iframe && self.checkIframeStatus) {\r\n                    // Set state as false ( for now )\r\n                    self.ready = false;\r\n\r\n                    // Append iframe\r\n                    $media.innerHTML = '';\r\n                    $media.appendChild(self.iframe as Node);\r\n\r\n                    // On iframe load, set state as ready to play full preview\r\n                    (self.iframe) && self.iframe.addEventListener('load', function(){\r\n                        self.ready = true;\r\n                        if (self.iframe) {\r\n                            const iframeStyles = self.iframe.style.cssText;\r\n                            self.iframe.style.cssText = iframeStyles?.concat('visibility: visible;');\r\n                        }\r\n                    });\r\n                }\r\n\r\n                self.emitter?.emit('start', self);\r\n            }\r\n        };\r\n        const getNewMedia = (): HTMLElement | null => {\r\n            const $region = document.getElementById(`${self.region.containerName}`);\r\n            // This function is for checking whether\r\n            // the region still has to show a media item\r\n            // when another region is not finished yet\r\n            if (self.region.complete && !self.region.layout.allEnded) {\r\n                // Add currentMedia to the region\r\n\r\n                ($region) && $region.insertBefore(self.html as Node, $region.lastElementChild);\r\n\r\n                return self.html as HTMLElement;\r\n            }\r\n\r\n            return null;\r\n        };\r\n\r\n        showCurrentMedia();\r\n    };\r\n\r\n    mediaObject.stop = async function() {\r\n        const self = mediaObject;\r\n        const $media = document.getElementById(getMediaId(self));\r\n\r\n        if ($media) {\r\n            $media.style.display = 'none';\r\n            $media.remove();\r\n        }\r\n    };\r\n\r\n    \r\n    mediaObject.on = function<E extends keyof IMediaEvents>(event: E, callback: IMediaEvents[E]) {\r\n        return emitter.on(event, callback);\r\n    };\r\n\r\n    mediaObject.emitter = emitter;\r\n\r\n    mediaObject.init();\r\n\r\n    return mediaObject;\r\n}","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport { createNanoEvents } from \"nanoevents\";\r\nimport { ILayout, OptionsType } from '../../Types/Layout';\r\nimport { initialRegion, IRegion, IRegionEvents } from '../../Types/Region';\r\nimport { IMedia } from '../../Types/Media';\r\nimport { getMediaId, nextId } from '../Generators';\r\nimport { platform } from '../Platform';\r\nimport { Media } from '../Media';\r\nimport {\r\n    TransitionElementOptions,\r\n    TransitionNameType,\r\n    compassPoints,\r\n    flyTransitionKeyframes,\r\n    transitionElement,\r\n} from '../Transitions';\r\nimport {IXlr} from \"../../Types/XLR\";\r\n\r\nexport default function Region(\r\n    layout: ILayout,\r\n    xml: Element,\r\n    regionId: string,\r\n    options: OptionsType,\r\n    xlr: IXlr,\r\n) {\r\n    const props = {\r\n        layout: layout,\r\n        xml: xml,\r\n        regionId: regionId,\r\n        options: options,\r\n    }\r\n    const emitter = createNanoEvents<IRegionEvents>();\r\n    let regionObject: IRegion = {\r\n        ...initialRegion,\r\n        ...props,\r\n    };\r\n\r\n    regionObject.prepareRegion = function() {\r\n        const self = regionObject;\r\n        const {layout, options} = self;\r\n        self.id = props.regionId;\r\n        self.options = {...platform, ...props.options};\r\n        self.containerName = `R-${self.id}-${nextId(self.options as OptionsType & IRegion[\"options\"])}`;\r\n        self.xml = props.xml;\r\n        self.mediaObjects = [];\r\n\r\n        self.sWidth = (self.xml) && Number(self.xml?.getAttribute('width')) * layout.scaleFactor;\r\n        self.sHeight = (self.xml) && Number(self.xml?.getAttribute('height')) * layout.scaleFactor;\r\n        self.offsetX = (self.xml) && Number(self.xml?.getAttribute('left')) * layout.scaleFactor;\r\n        self.offsetY = (self.xml) && Number(self.xml?.getAttribute('top')) * layout.scaleFactor;\r\n        self.zIndex = (self.xml) && Number(self.xml?.getAttribute('zindex')) * layout.scaleFactor;\r\n        \r\n        const regionOptions = self.xml?.getElementsByTagName('options');\r\n\r\n        if (regionOptions) {\r\n            for (let _options of Array.from(regionOptions)) {\r\n                // Get options\r\n                const _regionOptions = _options.children;\r\n                for (let regionOption of Array.from(_regionOptions)) {\r\n                    self.options[regionOption.nodeName.toLowerCase()] = regionOption.textContent;\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        let $region = document.getElementById(self.containerName);\r\n        const $layout = document.getElementById(`${self.layout.containerName}`);\r\n\r\n        if ($region === null) {\r\n            $region = document.createElement('div');\r\n            $region.id = self.containerName;\r\n        }\r\n\r\n        ($layout) && $layout.appendChild($region);\r\n\r\n        /* Scale the Layout Container */\r\n        /* Add region styles */\r\n        $region.style.cssText = `\r\n            width: ${self.sWidth}px;\r\n            height: ${self.sHeight}px;\r\n            position: absolute;\r\n            left: ${self.offsetX}px;\r\n            top: ${self.offsetY}px;\r\n        `;\r\n        $region.className = 'region--item';\r\n\r\n        /* Parse region media objects */\r\n        const regionMediaItems = Array.from(self.xml.getElementsByTagName('media'));\r\n        self.totalMediaObjects = regionMediaItems.length;\r\n\r\n        Array.from(regionMediaItems).forEach((mediaXml, indx) => {\r\n            const mediaObj = Media(\r\n                self,\r\n                mediaXml?.getAttribute('id') || '',\r\n                mediaXml,\r\n                options as OptionsType & IRegion[\"options\"],\r\n                xlr,\r\n            );\r\n\r\n            mediaObj.index = indx;\r\n            self.mediaObjects.push(mediaObj);\r\n        });\r\n\r\n        self.prepareMediaObjects();\r\n    };\r\n\r\n    regionObject.finished = function() {\r\n        const self = regionObject;\r\n        console.log('Region::finished called . . . ', self.id);\r\n        // Mark as complete\r\n        self.complete = true;\r\n        self.layout.regions[regionObject.index] = regionObject;\r\n        self.layout.regionExpired();\r\n    };\r\n\r\n    regionObject.prepareMediaObjects = function() {\r\n        const self = regionObject;\r\n        let nextMediaIndex;\r\n\r\n        if (self.mediaObjects.length > 0) {\r\n\r\n            if (self.curMedia) {\r\n                self.oldMedia = self.curMedia;\r\n            } else {\r\n                self.oldMedia = undefined;\r\n            }\r\n\r\n            if (self.currentMediaIndex >= self.mediaObjects.length) {\r\n                self.currentMediaIndex = 0;\r\n            }\r\n\r\n            self.curMedia = self.mediaObjects[self.currentMediaIndex];\r\n\r\n            nextMediaIndex = self.currentMediaIndex + 1;\r\n\r\n            if (nextMediaIndex >= self.mediaObjects.length ||\r\n                (\r\n                    !Boolean(self.mediaObjects[nextMediaIndex]) &&\r\n                    self.mediaObjects.length === 1\r\n                )\r\n            ) {\r\n                nextMediaIndex = 0;\r\n            }\r\n\r\n            if (Boolean(self.mediaObjects[nextMediaIndex])) {\r\n                self.nxtMedia = self.mediaObjects[nextMediaIndex];\r\n            }\r\n\r\n            const $region = document.getElementById(`${self.containerName}`);\r\n            // Append available media to region DOM\r\n            if (self.curMedia) {\r\n                ($region) && $region.insertBefore(self.curMedia.html as Node, $region.lastElementChild);\r\n            }\r\n\r\n            if (self.nxtMedia) {\r\n                ($region) && $region.insertBefore(self.nxtMedia.html as Node, $region.lastElementChild);\r\n            }\r\n        }\r\n    };\r\n\r\n    regionObject.run = function() {\r\n        console.log('Called Region::run > ', regionObject.id);\r\n\r\n        if (regionObject.curMedia) {\r\n            regionObject.transitionNodes(regionObject.oldMedia, regionObject.curMedia);\r\n        }\r\n    };\r\n\r\n    regionObject.transitionNodes = function(oldMedia: IMedia | undefined, newMedia: IMedia | undefined) {\r\n        const self = regionObject;\r\n        let transOutDuration = 1;\r\n        let transOutDirection: compassPoints = 'E';\r\n\r\n        if (newMedia) {\r\n            if (oldMedia && Boolean(oldMedia.options['transoutduration'])) {\r\n                transOutDuration = Number(oldMedia.options.transoutduration);\r\n            }\r\n\r\n            if (oldMedia && Boolean(oldMedia.options['transoutdirection'])) {\r\n                transOutDirection = oldMedia.options.transoutdirection;\r\n            }\r\n    \r\n            let defaultTransOutOptions: TransitionElementOptions = {duration: transOutDuration};\r\n            let transOut = transitionElement('defaultOut', {duration: defaultTransOutOptions.duration});\r\n    \r\n            let transOutName: TransitionNameType | string;\r\n            if (oldMedia && Boolean(oldMedia.options['transout'])) {\r\n                transOutName = oldMedia.options['transout'];\r\n    \r\n                if (transOutName === 'fly') {\r\n                    transOutName = `${transOutName}Out`;\r\n                    defaultTransOutOptions.keyframes = flyTransitionKeyframes({\r\n                        trans: 'out',\r\n                        direction: transOutDirection,\r\n                        height: oldMedia.divHeight,\r\n                        width: oldMedia.divWidth,\r\n                    });\r\n                }\r\n                \r\n                transOut = transitionElement(transOutName as TransitionNameType, defaultTransOutOptions);\r\n            }\r\n            \r\n            const hideOldMedia = new Promise((resolve) => {\r\n                // Hide oldMedia\r\n                if (oldMedia) {\r\n                    const $oldMedia = document.getElementById(getMediaId(oldMedia));\r\n                    if ($oldMedia) {\r\n                        const removeOldMedia = () => {\r\n                            $oldMedia.style.setProperty('display', 'none');\r\n                            $oldMedia.remove();\r\n                        };\r\n\r\n                        let oldMediaAnimate: any;\r\n                        if (Boolean(oldMedia.options['transout'])) {\r\n                            oldMediaAnimate = $oldMedia.animate(transOut.keyframes, transOut.timing);\r\n                        }\r\n\r\n                        if (Boolean(oldMedia.options['transout']) && self.totalMediaObjects > 1) {\r\n                            if (transOutName === 'flyOut') {\r\n                                // Reset last item to original position and state\r\n                                oldMediaAnimate ? oldMediaAnimate.finished\r\n                                    .then(() => {\r\n                                        resolve(true);\r\n                                        oldMediaAnimate?.effect?.updateTiming({fill: 'none'});\r\n                                        removeOldMedia();\r\n                                    }) : undefined;\r\n                            } else {\r\n                                setTimeout(removeOldMedia, transOutDuration / 2);\r\n                                resolve(true);\r\n                            }\r\n                        } else {\r\n                            removeOldMedia();\r\n                            // Resolve this right away\r\n                            // As a result, the transition between two media object\r\n                            // seems like a cross-over\r\n                            resolve(true);\r\n\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n    \r\n            if (oldMedia) {\r\n                hideOldMedia.then((isDone) => {\r\n                    if (isDone) {\r\n                        newMedia.run();\r\n                    }\r\n                });\r\n            } else {\r\n                newMedia.run();\r\n            }\r\n        }\r\n    };\r\n\r\n    regionObject.playNextMedia = function() {\r\n        const self = regionObject;\r\n\r\n        /* The current media has finished running */\r\n        if (self.ended) {\r\n            return;\r\n        }\r\n\r\n        if (self.currentMediaIndex === self.mediaObjects.length - 1) {\r\n            self.finished();\r\n\r\n            if (self.layout.allEnded) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // When the region has completed and when currentMedia is html\r\n        // Then, preserve the currentMedia state\r\n        if (self.complete &&\r\n            self.curMedia?.render === 'html'\r\n        ) {\r\n            return;\r\n        }\r\n\r\n        // When the region has completed and mediaObjects.length = 1\r\n        // and curMedia.loop = false, then put the media on\r\n        // its current state\r\n        if (self.complete && self.mediaObjects.length === 1 &&\r\n            self.curMedia?.render !== 'html' &&\r\n            self.curMedia?.mediaType === 'image' &&\r\n            !self.curMedia?.loop\r\n        ) {\r\n            return;\r\n        }\r\n\r\n        self.currentMediaIndex = self.currentMediaIndex + 1;\r\n        self.prepareMediaObjects();\r\n\r\n        self.transitionNodes(self.oldMedia, self.curMedia);\r\n    };\r\n    \r\n    regionObject.end = function() {\r\n        const self = regionObject;\r\n        self.ending = true;\r\n        /* The Layout has finished running */\r\n        /* Do any region exit transition then clean up */\r\n        self.layout.regions[self.index] = self;\r\n\r\n        console.log('Calling Region::end ', self);\r\n        self.exitTransition();\r\n    };\r\n\r\n    regionObject.exitTransition = function() {\r\n        const self = regionObject;\r\n        /* TODO: Actually implement region exit transitions */\r\n        const $region = document.getElementById(`${self.containerName}`);\r\n\r\n        if ($region) {\r\n            $region.style.display = 'none';\r\n        }\r\n\r\n        console.log('Called Region::exitTransition ', self.id);\r\n\r\n        self.exitTransitionComplete();\r\n    };\r\n\r\n    regionObject.exitTransitionComplete = function() {\r\n        const self = regionObject;\r\n        console.log('Called Region::exitTransitionComplete ', self.id);\r\n        self.ended = true;\r\n        self.layout.regions[self.index] = self;\r\n        self.layout.regionEnded();\r\n    };\r\n\r\n    regionObject.on = function<E extends keyof IRegionEvents>(event: E, callback: IRegionEvents[E]) {\r\n        return emitter.on(event, callback);\r\n    };\r\n\r\n    regionObject.emitter = emitter;\r\n\r\n    regionObject.prepareRegion();\r\n\r\n    return regionObject;\r\n}","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport {createNanoEvents} from 'nanoevents';\r\nimport {\r\n    GetLayoutParamType,\r\n    GetLayoutType,\r\n    ILayout,\r\n    initialLayout,\r\n    OptionsType,\r\n} from '../../Types/Layout';\r\nimport { IXlr } from '../../Types/XLR';\r\nimport { nextId } from '../Generators';\r\nimport { Region } from '../Region';\r\n\r\nimport './layout.css';\r\nimport {getIndexByLayoutId} from '../Generators/Generators';\r\n\r\nconst playAgainClickHandle = function(ev: { preventDefault: () => void; }) {\r\n    ev.preventDefault();\r\n    history.go(0);\r\n};\r\n\r\nexport function initRenderingDOM(targetContainer: Element | null) {\r\n    let _targetContainer = targetContainer;\r\n    const previewPlayer = document.createElement('div');\r\n    const previewScreen = document.createElement('div');\r\n    const endPlay = document.createElement('div');\r\n    const playAgainLink = document.createElement('a');\r\n\r\n    // Preview player\r\n    previewPlayer.className = 'player-preview';\r\n    previewPlayer.id = 'player_container';\r\n\r\n    // Preview screen\r\n    previewScreen.className = 'screen-preview';\r\n    previewScreen.id = 'screen_container';\r\n\r\n    // Ended play\r\n    endPlay.className = 'preview-ended';\r\n    endPlay.id = 'play_ended';\r\n    endPlay.style.display = 'none';\r\n\r\n    // Play again link\r\n    playAgainLink.id = 'play_back_preview';\r\n    playAgainLink.className = 'play-back-preview';\r\n    playAgainLink.style.cssText = 'text-decoration: none; color: #ffffff;';\r\n    playAgainLink.innerHTML = 'Play again?';\r\n    playAgainLink.removeEventListener('click', playAgainClickHandle);\r\n    playAgainLink.addEventListener('click', playAgainClickHandle);\r\n\r\n    if (!_targetContainer) {\r\n        _targetContainer = document.body;\r\n    }\r\n\r\n    if (_targetContainer) {\r\n        if (_targetContainer.querySelector('#player_container') === null) {\r\n            _targetContainer.insertBefore(previewPlayer, _targetContainer.firstChild);\r\n\r\n            if (previewPlayer.querySelector('#screen_container') === null) {\r\n                previewPlayer.appendChild(previewScreen);\r\n            }\r\n\r\n            if (previewPlayer.querySelector('#play_ended') === null) {\r\n                previewPlayer.appendChild(endPlay);\r\n\r\n                if (endPlay.querySelector('a') === null) {\r\n                    endPlay.appendChild(playAgainLink);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport async function getXlf(layoutOptions: OptionsType) {\r\n    let apiHost = window.location.origin;\r\n\r\n    let xlfUrl = apiHost + layoutOptions.xlfUrl;\r\n    let fetchOptions: RequestInit = {};\r\n\r\n    if (layoutOptions.platform === 'CMS') {\r\n        xlfUrl = apiHost + layoutOptions.xlfUrl;\r\n        fetchOptions.mode = 'no-cors';\r\n    } else if (layoutOptions.platform === 'chromeOS') {\r\n        xlfUrl = layoutOptions.xlfUrl;\r\n        fetchOptions.mode = 'cors';\r\n        fetchOptions.headers = {\r\n            'Content-Type': 'text/xml',\r\n        };\r\n    } else if (layoutOptions.platform !== 'CMS' && layoutOptions.appHost !== null) {\r\n        xlfUrl = layoutOptions.appHost + layoutOptions.xlfUrl;\r\n    }\r\n\r\n    const res = await fetch(xlfUrl);\r\n\r\n    return await res.text();\r\n}\r\n\r\nexport function handleAxiosError(error: any, message?: string) {\r\n    console.error(error);\r\n    if (error.response.status == 500) {\r\n        // SOAP responses are always 500's\r\n        // Return the body\r\n        throw new Error(error.response.data);\r\n    } else {\r\n        throw new Error(message || 'Unknown Error');\r\n    }\r\n}\r\n\r\nexport function getLayout(params: GetLayoutParamType): GetLayoutType {\r\n    let _currentLayout = undefined;\r\n    let _nextLayout = undefined;\r\n    let {\r\n        inputLayouts,\r\n        currentLayout,\r\n        nextLayout,\r\n        currentLayoutIndex: currLayoutIndx\r\n    } = params.xlr;\r\n    const hasLayout = inputLayouts.length > 0;\r\n    let currentLayoutIndex = currLayoutIndx;\r\n    let nextLayoutIndex = currentLayoutIndex + 1;\r\n\r\n    if (currentLayout === undefined && nextLayout === undefined) {\r\n        let activeLayout;\r\n        // Preview just got started\r\n        if (hasLayout) {\r\n            let nextLayoutTemp = {...initialLayout};\r\n            activeLayout = inputLayouts[currentLayoutIndex];\r\n            _currentLayout = {...initialLayout, ...activeLayout};\r\n\r\n            if (inputLayouts.length > 1) {\r\n                nextLayoutTemp = {...nextLayoutTemp, ...inputLayouts[nextLayoutIndex]};\r\n                _nextLayout = nextLayoutTemp;\r\n            } else {\r\n                _nextLayout = _currentLayout;\r\n            }\r\n\r\n            _currentLayout.id = activeLayout.layoutId;\r\n\r\n            if (nextLayoutTemp) {\r\n                _nextLayout.id = nextLayoutTemp.layoutId;\r\n            }\r\n        }\r\n    } else {\r\n        if (hasLayout) {\r\n            _currentLayout = nextLayout;\r\n\r\n            currentLayoutIndex = getIndexByLayoutId(inputLayouts, _currentLayout?.layoutId).index as number;\r\n            nextLayoutIndex = currentLayoutIndex + 1;\r\n\r\n            if (inputLayouts.length > 1 && nextLayoutIndex < inputLayouts.length) {\r\n                if (Boolean(params.xlr.layouts[nextLayoutIndex])) {\r\n                    _nextLayout = params.xlr.layouts[nextLayoutIndex];\r\n                } else {\r\n                    _nextLayout = {...initialLayout, ...inputLayouts[nextLayoutIndex]};\r\n                }\r\n            }\r\n\r\n            // If _nextLayout is undefined, then we go back to first layout\r\n            if (_nextLayout === undefined) {\r\n                _nextLayout = params.xlr.layouts[0];\r\n            }\r\n        }\r\n    }\r\n\r\n    return {\r\n        currentLayoutIndex,\r\n        inputLayouts: params.xlr.inputLayouts,\r\n        current: _currentLayout,\r\n        next: _nextLayout,\r\n    }\r\n}\r\n\r\nexport interface ILayoutEvents {\r\n    start: (layout: ILayout) => void;\r\n    end: (layout: ILayout) => void;\r\n}\r\n\r\nexport default function Layout(\r\n    data: Document | null,\r\n    options: OptionsType,\r\n    xlr: IXlr,\r\n    layout?: ILayout\r\n) {\r\n    const props = {\r\n        data: data,\r\n        options: options,\r\n        layout: layout || initialLayout,\r\n    }\r\n    const emitter = createNanoEvents<ILayoutEvents>();\r\n\r\n    emitter.on('start', (layout) => {\r\n        layout.done = false;\r\n        console.log('Layout start emitted > Layout ID > ', layout.id);\r\n    });\r\n\r\n    emitter.on('end', (layout) => {\r\n        console.log('Ending layout with ID of > ', layout.layoutId);\r\n        layout.done = true;\r\n        /* Remove layout that has ended */\r\n        const $layout = document.getElementById(layout.containerName);\r\n\r\n        console.log({$layout});\r\n\r\n        if ($layout !== null) {\r\n            $layout.remove();\r\n        }\r\n\r\n        if (xlr.config.platform !== 'CMS') {\r\n            // Transition next layout to current layout and prepare next layout if exist\r\n            xlr.prepareLayouts().then((parent) => {\r\n                xlr.playSchedules(parent);\r\n            });\r\n        }\r\n    });\r\n\r\n    const layoutObject: ILayout = {\r\n        ...props.layout,\r\n        options: props.options,\r\n        emitter,\r\n    };\r\n\r\n    layoutObject.on = function<E extends keyof ILayoutEvents>(event: E, callback: ILayoutEvents[E]) {\r\n        return emitter.on(event, callback);\r\n    };\r\n    layoutObject.run = function() {\r\n        const layout = layoutObject;\r\n        const $layoutContainer = document.getElementById(`${layout.containerName}`);\r\n        const $splashScreen = document.getElementById(`splash_${layout.id}`);\r\n\r\n        if ($layoutContainer) {\r\n            $layoutContainer.style.display = 'block';\r\n        }\r\n\r\n        if ($splashScreen) {\r\n            $splashScreen.style.display = 'none';\r\n        }\r\n\r\n        console.log('Layout running > Layout ID > ', layout.id);\r\n        console.log('Layout Regions > ', layout.regions);\r\n        for (let i = 0; i < layout.regions.length; i++) {\r\n            // playLog(4, \"debug\", \"Running region \" + self.regions[i].id, false);\r\n            layout.regions[i].run();\r\n        }\r\n    };\r\n\r\n    layoutObject.parseXlf = function() {\r\n        const layout = layoutObject;\r\n        const {data, options} = props;\r\n        layout.containerName = \"L\" + layout.id + \"-\" + nextId(options);\r\n        layout.regions = [];\r\n\r\n        /* Create a hidden div to show the layout in */\r\n        let $layout = document.getElementById(layout.containerName);\r\n\r\n        if ($layout === null) {\r\n            $layout = document.createElement('div');\r\n            $layout.id = layout.containerName;\r\n        }\r\n\r\n        let $screen = document.getElementById('screen_container');\r\n        ($screen) && $screen.appendChild($layout);\r\n\r\n        if ($layout) {\r\n            $layout.style.display = 'none';\r\n            $layout.style.outline = 'red solid thin';\r\n        }\r\n\r\n        layout.layoutNode = data;\r\n\r\n        /* Calculate the screen size */\r\n        layout.sw = $screen?.offsetWidth || 0;\r\n        layout.sh = $screen?.offsetHeight || 0;\r\n\r\n        layout.xw = Number(layout.layoutNode?.firstElementChild?.getAttribute('width'));\r\n        layout.xh = Number(layout.layoutNode?.firstElementChild?.getAttribute('height'));\r\n        layout.zIndex = Number(layout.layoutNode?.firstElementChild?.getAttribute('zindex')) || 0;\r\n\r\n        /* Calculate Scale Factor */\r\n        layout.scaleFactor = Math.min((layout.sw / layout.xw), (layout.sh / layout.xh));\r\n        layout.sWidth = Math.round(layout.xw * layout.scaleFactor);\r\n        layout.sHeight = Math.round(layout.xh * layout.scaleFactor);\r\n        layout.offsetX = Math.abs(layout.sw - layout.sWidth) / 2;\r\n        layout.offsetY = Math.abs(layout.sh - layout.sHeight) / 2;\r\n\r\n        const layoutStyles = `\r\n            width: ${layout.sWidth}px;\r\n            height: ${layout.sHeight}px;\r\n            position: absolute;\r\n            left: ${layout.offsetX}px;\r\n            top: ${layout.offsetY}px;\r\n        `;\r\n        /* Scale the Layout Container */\r\n        if ($layout) {\r\n            $layout.style.cssText = layoutStyles;\r\n        }\r\n\r\n        if ($layout && layout.zIndex !== null) {\r\n            $layout.style.cssText = layoutStyles.concat(`z-index: ${layout.zIndex};`);\r\n        }\r\n\r\n        /* Set the layout background */\r\n        layout.bgColor = layout.layoutNode?.firstElementChild?.getAttribute('bgcolor') || '';\r\n        layout.bgImage = layout.layoutNode?.firstElementChild?.getAttribute('background') || '';\r\n\r\n        if (!(layout.bgImage === \"\" || typeof layout.bgImage === 'undefined')) {\r\n            /* Extract the image ID from the filename */\r\n            layout.bgId = layout.bgImage.substring(0, layout.bgImage.indexOf('.'));\r\n\r\n            let tmpUrl = options.layoutBackgroundDownloadUrl.replace(\":id\", (layout.id as unknown) as string) + '?preview=1';\r\n\r\n            // preload.addFiles(tmpUrl + \"&width=\" + self.sWidth + \"&height=\" + self.sHeight + \"&dynamic&proportional=0\");\r\n            if ($layout) {\r\n                $layout.style.cssText = layoutStyles.concat(`\r\n                    background: url('${tmpUrl}&width=${layout.sWidth}&height=${layout.sHeight}&dynamic&proportional=0');\r\n                    backgroundRepeat: \"no-repeat\";\r\n                    backgroundSize: ${layout.sWidth}px ${layout.sHeight}px;\r\n                    backgroundPosition: \"0px 0px\";\r\n                `);\r\n            }\r\n        }\r\n\r\n        // Set the background color\r\n        if ($layout) {\r\n            $layout.style.cssText = layoutStyles.concat(`background-color: layout.bgColor;`);\r\n        }\r\n\r\n        // Hide if layout is not the currentLayout\r\n        if ($layout && xlr.currentLayoutId !== undefined && xlr.currentLayoutId !== layout.id) {\r\n            $layout.style.cssText = $layout.style.cssText.concat('display: none;');\r\n        }\r\n\r\n        // Create regions\r\n        const layoutRegions = Array.from(layout?.layoutNode?.getElementsByTagName('region') || []);\r\n\r\n        Array.from(layoutRegions).forEach((regionXml, indx) => {\r\n            const regionObj = Region(\r\n                layout,\r\n                regionXml,\r\n                regionXml?.getAttribute('id') || '',\r\n                options,\r\n                xlr,\r\n            );\r\n\r\n            regionObj.index = indx;\r\n            layout.regions.push(regionObj);\r\n        });\r\n    };\r\n\r\n    layoutObject.prepareLayout = function() {\r\n        layoutObject.parseXlf();\r\n    };\r\n\r\n    layoutObject.regionExpired = function() {\r\n        const self = layoutObject;\r\n        self.allExpired = true;\r\n\r\n        for (let layoutRegion of self.regions) {\r\n            if (!layoutRegion.complete) {\r\n                self.allExpired = false;\r\n            }\r\n        }\r\n\r\n        if (self.allExpired) {\r\n            self.end();\r\n        }\r\n    };\r\n\r\n    layoutObject.regionEnded = function() {\r\n        const self = layoutObject;\r\n        self.allEnded = true;\r\n        \r\n        for (var i = 0; i < self.regions.length; i++) {\r\n            if (! self.regions[i].ended) {\r\n                self.allEnded = false;\r\n            }\r\n        }\r\n        \r\n        if (self.allEnded) {\r\n            self.stopAllMedia().then(() => {\r\n                console.log('starting to end layout . . .');\r\n                if (xlr.config.platform === 'CMS') {\r\n                    const $end = document.getElementById('play_ended');\r\n                    const $preview = document.getElementById('screen_container');\r\n        \r\n                    if ($preview) {\r\n                        while($preview.firstChild) {\r\n                            $preview.removeChild($preview.firstChild);\r\n                        }\r\n        \r\n                        $preview.style.display = 'none';\r\n                    }\r\n        \r\n                    if ($end) {\r\n                        $end.style.display = 'block';\r\n                    }\r\n                }\r\n                \r\n                self.emitter?.emit('end', self);\r\n            });\r\n\r\n        }\r\n    };\r\n\r\n    layoutObject.end = function() {\r\n        console.log('Executing Layout::end and Calling Region::end ', layoutObject);\r\n\r\n        /* Ask the layout to gracefully stop running now */\r\n        for (let layoutRegion of layoutObject.regions) {\r\n            layoutRegion.end();\r\n        }\r\n    };\r\n\r\n    layoutObject.stopAllMedia = function() {\r\n        console.log('Stopping all media . . .');\r\n        return new Promise(async (resolve) => {\r\n            for(var i = 0;i < layoutObject.regions.length;i++) {\r\n                var region = layoutObject.regions[i];\r\n                for(var j = 0;j < region.mediaObjects.length;j++) {\r\n                    var media = region.mediaObjects[j];\r\n                    await media.stop();\r\n                }\r\n            }\r\n\r\n            resolve();\r\n        });\r\n    };\r\n\r\n    layoutObject.prepareLayout();\r\n\r\n    return layoutObject;\r\n}\r\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport {ILayout, InputLayoutType, OptionsType} from \"../Layout/Layout.types\";\r\nimport {platform} from \"../../Modules/Platform/Platform\";\r\n\r\nexport type PrepareLayoutsType = {\r\n    moveNext?: boolean;\r\n};\r\n\r\nexport enum ELayoutType {\r\n    CURRENT,\r\n    NEXT,\r\n}\r\n\r\nexport interface IXlr {\r\n    inputLayouts: InputLayoutType[],\r\n    config: OptionsType,\r\n    layouts: ILayout[],\r\n    currentLayoutIndex: number;\r\n    currentLayoutId: number | null;\r\n    currentLayout: ILayout | undefined;\r\n    nextLayout: ILayout | undefined;\r\n    bootstrap(): void;\r\n    init(): Promise<IXlr>;\r\n    playSchedules(xlr: IXlr): void;\r\n    prepareLayoutXlf(inputLayout: ILayout | undefined): Promise<ILayout>;\r\n    prepareLayouts(): Promise<IXlr>;\r\n}\r\n\r\nexport const initialXlr: IXlr = {\r\n    inputLayouts: [],\r\n    config: platform,\r\n    layouts: [],\r\n    currentLayoutIndex: 0,\r\n    currentLayoutId: null,\r\n    currentLayout: undefined,\r\n    nextLayout: undefined,\r\n    bootstrap() {\r\n    },\r\n    init() {\r\n        return Promise.resolve(<IXlr>{});\r\n    },\r\n    playSchedules() {\r\n    },\r\n    prepareLayoutXlf(inputLayout: ILayout | undefined): Promise<ILayout> {\r\n        return Promise.resolve(<ILayout>{});\r\n    },\r\n    prepareLayouts(): Promise<IXlr> {\r\n        return Promise.resolve(<IXlr>{});\r\n    }\r\n};\r\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport {\r\n    Layout, getLayout, getXlf, initRenderingDOM\r\n} from \"./Modules/Layout\";\r\nimport { platform } from './Modules/Platform';\r\nimport {\r\n    ILayout, initialLayout, InputLayoutType, OptionsType,\r\n} from \"./Types/Layout\";\r\nimport { ELayoutType, initialXlr, IXlr } from './Types/XLR';\r\n\r\nexport default function XiboLayoutRenderer(\r\n    inputLayouts: InputLayoutType[],\r\n    options?: OptionsType,\r\n) {\r\n    const props = {\r\n        inputLayouts,\r\n        options,\r\n    }\r\n\r\n    const xlrObject: IXlr = {\r\n        ...initialXlr,\r\n        bootstrap() {\r\n            // Place to set configurations and initialize required props\r\n            const self = this;\r\n            self.inputLayouts = !Array.isArray(props.inputLayouts) ?\r\n                [props.inputLayouts] : props.inputLayouts;\r\n            self.config = JSON.parse(JSON.stringify({...platform, ...props.options}));\r\n        },\r\n        init() {\r\n            return new Promise<IXlr>((resolve) => {\r\n                const self = this;\r\n\r\n                // Prepare rendering DOM\r\n                const previewCanvas = document.querySelector('.preview-canvas');\r\n\r\n                initRenderingDOM(previewCanvas);\r\n\r\n                self.prepareLayouts().then((xlr) => {\r\n                    resolve(xlr);\r\n                });\r\n            });\r\n        },\r\n\r\n        playSchedules(xlr: IXlr) {\r\n            // Check if there's a current layout\r\n            if (xlr.currentLayout !== undefined) {\r\n                xlr.currentLayout.emitter?.emit('start', xlr.currentLayout);\r\n                xlr.currentLayout.run();\r\n            }\r\n        },\r\n\r\n        async prepareLayoutXlf(inputLayout: ILayout) {\r\n            const self = this;\r\n            // Compose layout props first\r\n            let newOptions: OptionsType = Object.assign({}, platform);\r\n\r\n            newOptions = {\r\n                ...newOptions,\r\n                ...props.options,\r\n            };\r\n\r\n            if (self.config.platform ==='CMS' &&\r\n                inputLayout && Boolean(inputLayout.layoutId)\r\n            ) {\r\n                newOptions.xlfUrl =\r\n                    newOptions.xlfUrl.replace(':layoutId', String(inputLayout.layoutId));\r\n            } else if (self.config.platform === 'chromeOS') {\r\n                newOptions.xlfUrl = inputLayout.path as string;\r\n            }\r\n\r\n            let layoutXlf: string;\r\n            let layoutXlfNode: Document | null;\r\n            if (inputLayout && inputLayout.layoutNode === null) {\r\n                layoutXlf = await getXlf(newOptions);\r\n\r\n                const parser = new window.DOMParser();\r\n                layoutXlfNode = parser.parseFromString(layoutXlf as string, 'text/xml');\r\n            } else {\r\n                layoutXlfNode = inputLayout && inputLayout.layoutNode;\r\n            }\r\n\r\n            return new Promise<ILayout>((resolve) => {\r\n                const xlrLayoutObj = initialLayout;\r\n                \r\n                xlrLayoutObj.id = Number(inputLayout.layoutId);\r\n                xlrLayoutObj.layoutId = Number(inputLayout.layoutId);\r\n                xlrLayoutObj.options = newOptions;\r\n\r\n                resolve(Layout(layoutXlfNode, newOptions, self, xlrLayoutObj));\r\n            });\r\n        },\r\n\r\n        async prepareLayouts() {\r\n            const self = this;\r\n            // Get layouts\r\n            const xlrLayouts = getLayout({xlr: self});\r\n\r\n            self.currentLayoutId = xlrLayouts.current?.layoutId as ILayout['layoutId'];\r\n\r\n            const layoutsXlf = () => {\r\n                let xlf = [];\r\n\r\n                xlf.push(xlrLayouts.current);\r\n\r\n                if (xlrLayouts.current?.layoutId !== xlrLayouts.next?.layoutId) {\r\n                    xlf.push(xlrLayouts.next);\r\n                }\r\n\r\n                return xlf.reduce((coll: Promise<ILayout>[], item) => {\r\n                    return [\r\n                        ...coll,\r\n                        self.prepareLayoutXlf(item),\r\n                    ];\r\n                }, []);\r\n            };\r\n            const layouts = await Promise.all<Array<Promise<ILayout>>>(layoutsXlf());\r\n\r\n            return new Promise<IXlr>((resolve) => {\r\n                self.layouts = layouts;\r\n                self.currentLayout = self.layouts[0];\r\n\r\n                if (Boolean(self.layouts[1])) {\r\n                    self.nextLayout = self.layouts[1];\r\n                } else {\r\n                    // Use current layout as next layout if only one layout is available\r\n                    self.nextLayout = self.layouts[0];\r\n                }\r\n\r\n                self.currentLayoutIndex = xlrLayouts.currentLayoutIndex;\r\n                self.layouts[self.currentLayoutIndex] = self.currentLayout;\r\n\r\n                resolve(self);\r\n            });\r\n        },\r\n    }\r\n\r\n    xlrObject.bootstrap();\r\n\r\n    return xlrObject;\r\n}\r\n"],"names":[],"mappings":"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","x_google_ignoreList":[0]}