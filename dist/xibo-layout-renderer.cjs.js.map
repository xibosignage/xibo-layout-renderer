{"version":3,"file":"xibo-layout-renderer.cjs.js","sources":["../node_modules/nanoevents/index.js","../../src/Modules/Platform/Platform.ts","../../src/Types/Layout/Layout.types.ts","../../src/Modules/Generators/Generators.ts","../../src/Types/Region/Region.types.ts","../../src/Types/Media/Media.types.ts","../../src/Modules/Transitions/Transitions.ts","../../src/Modules/Media/VideoMedia.ts","../../src/Modules/Media/AudioMedia.ts","../../src/Modules/Media/Media.ts","../../src/Modules/Region/Region.ts","../../src/Modules/Layout/Layout.ts","../../src/Types/XLR/XLR.types.ts","../../src/Modules/SplashScreen/SplashScreen.ts","../../src/xibo-layout-renderer.ts"],"sourcesContent":["export let createNanoEvents = () => ({\n  emit(event, ...args) {\n    for (\n      let i = 0,\n        callbacks = this.events[event] || [],\n        length = callbacks.length;\n      i < length;\n      i++\n    ) {\n      callbacks[i](...args)\n    }\n  },\n  events: {},\n  on(event, cb) {\n    ;(this.events[event] ||= []).push(cb)\n    return () => {\n      this.events[event] = this.events[event]?.filter(i => cb !== i)\n    }\n  }\n})\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport {OptionsType} from \"../../Types/Layout\";\r\n\r\nconst RESOURCE_URL = '/playlist/widget/resource/:regionId/:id';\r\nconst XLF_URL = '/layout/xlf/:layoutId';\r\nconst LAYOUT_BACKGROUND_DOWNLOAD_URL = '/layout/background/:id';\r\nconst LAYOUT_PREVIEW_URL = '/layout/preview/[layoutCode]';\r\nconst LIBRARY_DOWNLOAD_URL = '/library/download/:id';\r\nconst LOADER_URL = '/theme/default/img/loader.gif';\r\n\r\nexport const platform: OptionsType = {\r\n    getResourceUrl: RESOURCE_URL,\r\n    xlfUrl: XLF_URL,\r\n    layoutBackgroundDownloadUrl: LAYOUT_BACKGROUND_DOWNLOAD_URL,\r\n    layoutPreviewUrl: LAYOUT_PREVIEW_URL,\r\n    libraryDownloadUrl: LIBRARY_DOWNLOAD_URL,\r\n    loaderUrl: LOADER_URL,\r\n    idCounter: 0,\r\n    inPreview: true,\r\n    appHost: null,\r\n    platform: 'CMS',\r\n};\r\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport {DefaultEvents, Emitter, Unsubscribe} from 'nanoevents';\r\nimport {IRegion} from '../Region';\r\nimport {platform} from '../../Modules/Platform';\r\nimport {ILayoutEvents} from '../../Modules/Layout';\r\nimport {IXlr} from '../XLR';\r\n\r\nexport type InputLayoutType = {\r\n    layoutId: number | null;\r\n    path?: string;\r\n};\r\n\r\nexport type OptionsType = {\r\n    xlfUrl: string;\r\n    getResourceUrl: string;\r\n    layoutBackgroundDownloadUrl: string;\r\n    layoutPreviewUrl: string;\r\n    libraryDownloadUrl: string;\r\n    loaderUrl: string;\r\n    idCounter: number;\r\n    inPreview: boolean;\r\n    appHost?: string | null;\r\n    platform: 'CMS' | 'chromeOS';\r\n    config?: {\r\n        cmsUrl: string | null;\r\n        schemaVersion: number;\r\n        cmsKey: string | null;\r\n        hardwareKey: string | null;\r\n    };\r\n};\r\n\r\nexport interface ILayout {\r\n    id: number | null;\r\n    layoutId: number | null;\r\n    sw: number | null;\r\n    sh: number | null;\r\n    xw: number | null;\r\n    xh: number | null;\r\n    zIndex: number | null;\r\n    scaleFactor: number;\r\n    sWidth: number;\r\n    sHeight: number;\r\n    offsetX: number;\r\n    offsetY: number;\r\n    bgColor: string;\r\n    bgImage: string;\r\n    bgId: string;\r\n    containerName: string;\r\n    layoutNode: Document | null;\r\n    regionMaxZIndex: number;\r\n    ready: boolean;\r\n    regionObjects: IRegion[];\r\n    drawer: String[];\r\n    allExpired: boolean;\r\n    regions: IRegion[];\r\n    actions: String[];\r\n    options: OptionsType;\r\n    done: boolean;\r\n    allEnded: boolean;\r\n    path?: string;\r\n    prepareLayout(): void;\r\n    parseXlf(): void;\r\n    run(): void;\r\n    emitter?: Emitter<DefaultEvents>;\r\n    on<E extends keyof ILayoutEvents>(event: E, callback: ILayoutEvents[E]): Unsubscribe;\r\n    regionExpired(): void;\r\n    end(): void;\r\n    regionEnded(): void;\r\n    stopAllMedia(): Promise<void>;\r\n}\r\n\r\nexport const initialLayout: ILayout = {\r\n    id: null,\r\n    layoutId: null,\r\n    sw: 0,\r\n    sh: 0,\r\n    xw: 0,\r\n    xh: 0,\r\n    zIndex: 0,\r\n    scaleFactor: 1,\r\n    sWidth: 0,\r\n    sHeight: 0,\r\n    offsetX: 0,\r\n    offsetY: 0,\r\n    bgColor: '',\r\n    bgImage: '',\r\n    bgId: '',\r\n    containerName: '',\r\n    layoutNode: null,\r\n    regionMaxZIndex: 0,\r\n    ready: false,\r\n    regionObjects: [],\r\n    drawer: [],\r\n    allExpired: false,\r\n    regions: [],\r\n    actions: [],\r\n    options: platform,\r\n    done: false,\r\n    allEnded: false,\r\n    path: '',\r\n    prepareLayout() {\r\n    },\r\n    parseXlf() {\r\n    },\r\n    run() {\r\n    },\r\n    on<E extends keyof ILayoutEvents>(event: E, callback: ILayoutEvents[E]): Unsubscribe {\r\n        return <Unsubscribe>{};\r\n    },\r\n    regionExpired() {\r\n    },\r\n    end() {\r\n    },\r\n    regionEnded() {\r\n    },\r\n    stopAllMedia() {\r\n        return Promise.resolve();\r\n    },\r\n};\r\n\r\nexport type GetLayoutParamType = {\r\n    xlr: IXlr;\r\n    moveNext?: boolean;\r\n}\r\n\r\nexport type GetLayoutType = {\r\n    currentLayoutIndex: number;\r\n    inputLayouts: InputLayoutType[];\r\n    current: ILayout | undefined;\r\n    next: ILayout | undefined;\r\n}\r\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport { IMedia } from '../../Types/Media';\r\nimport {InputLayoutType, OptionsType} from '../../Types/Layout';\r\n\r\nexport function nextId(options: { idCounter: number; }) {\r\n    if (options.idCounter > 500) {\r\n        options.idCounter = 0;\r\n    }\r\n\r\n    options.idCounter = options.idCounter + 1;\r\n    return options.idCounter;\r\n}\r\n\r\nexport const getMediaId = ({mediaType, containerName}: IMedia) => {\r\n    let mediaId = containerName;\r\n\r\n    if (mediaType === 'video') {\r\n        mediaId = mediaId + '-vid';\r\n    } else if (mediaType === 'audio') {\r\n        mediaId = mediaId + '-aud';\r\n    }\r\n\r\n    return mediaId;\r\n};\r\n\r\nexport const capitalizeStr = (inputStr: string) => {\r\n    if (inputStr === null) {\r\n        return '';\r\n    }\r\n\r\n    return String(inputStr).charAt(0).toUpperCase() + String(inputStr).substring(1);\r\n};\r\n\r\nexport async function getDataBlob(src: string) {\r\n    return fetch(src, {mode: 'no-cors'})\r\n        .then((res) => res.blob())\r\n        .then((blob) => new Promise((res, rej) => {\r\n            const reader = new FileReader();\r\n\r\n            reader.onloadend = () => res(reader.result);\r\n            reader.onerror = rej;\r\n            reader.readAsDataURL(blob);\r\n        }));\r\n}\r\n\r\nexport async function preloadMediaBlob(src: string, type: 'video' | 'audio' | 'image') {\r\n    const res = await fetch(src, {mode: 'no-cors'});\r\n    let blob: Blob | MediaSource = new Blob();\r\n\r\n    if (type === 'image') {\r\n        blob = new Blob()\r\n    } else if (type === 'video') {\r\n        blob = await res.blob();\r\n    } else if (type === 'audio') {\r\n        const data = await res.arrayBuffer();\r\n        blob = new Blob([data], { type: audioFileType(getFileExt(src)) })\r\n    }\r\n\r\n    return URL.createObjectURL(blob);\r\n}\r\n\r\nexport async function fetchJSON(url: string) {\r\n    return fetch(url)\r\n        .then(res => res.json())\r\n        .catch(err => {\r\n            console.debug(err);\r\n        });\r\n}\r\n\r\nexport function getFileExt(filename: string) {\r\n    const filenameArr = String(filename).split('.');\r\n\r\n    return filenameArr[filenameArr.length - 1];\r\n}\r\n\r\nexport function audioFileType(str: string) {\r\n    const validAudioTypes = {\r\n        'mp3': 'audio/mp3',\r\n        'wav': 'audio/wav',\r\n        'ogg': 'audio/ogg',\r\n    };\r\n\r\n    if (Boolean(validAudioTypes[str as 'mp3' | 'wav' | 'ogg'])) {\r\n        return validAudioTypes[str as 'mp3' | 'wav' | 'ogg'];\r\n    }\r\n\r\n    return undefined;\r\n}\r\n\r\nexport function composeResourceUrlByPlatform(platform: OptionsType['platform'], params: any) {\r\n    let resourceUrl = params.regionOptions.getResourceUrl\r\n        .replace(\":regionId\", params.regionId)\r\n        .replace(\":id\", params.mediaId) +\r\n        '?preview=1&layoutPreview=1';\r\n\r\n    if (platform === 'chromeOS') {\r\n        resourceUrl = params.cmsUrl +\r\n            '/chromeOS/resource/' +\r\n            params.fileId +\r\n            '?saveAs=' + params.uri;\r\n    } else if (!Boolean(params['mediaType'])) {\r\n        resourceUrl += '&scale_override=' + params.scaleFactor;\r\n    }\r\n\r\n    return resourceUrl;\r\n}\r\n\r\nexport function composeBgUrlByPlatform(\r\n    platform: OptionsType['platform'],\r\n    params: any\r\n) {\r\n    let bgImageUrl = params.layoutBackgroundDownloadUrl.replace(\":id\", (params.layout.id as unknown) as string) +\r\n        '?preview=1&width=' + params.layout.sWidth +\r\n        '&height=' + params.layout.sHeight +\r\n        '&dynamic&proportional=0';\r\n\r\n    if (platform === 'chromeOS') {\r\n        bgImageUrl = params.cmsUrl +\r\n            '/chromeOS/resource/' + params.layout.id +\r\n            '?saveAs=' + params.layout.bgImage;\r\n    }\r\n\r\n    return bgImageUrl;\r\n}\r\n\r\ntype LayoutIndexType = {\r\n    [k: string]: InputLayoutType & {\r\n        index: number;\r\n    }\r\n}\r\n\r\nexport function getIndexByLayoutId(layoutsInput: InputLayoutType[], layoutId?: number | null) {\r\n    let layoutIndexes = layoutsInput.reduce((a: LayoutIndexType, b, indx) => {\r\n        a[Number(b.layoutId)] = {\r\n            ...b,\r\n            index: indx\r\n        };\r\n\r\n        return a;\r\n    }, {});\r\n\r\n    if (layoutId === null || !layoutId) {\r\n        return layoutIndexes;\r\n    }\r\n\r\n    return layoutIndexes[layoutId];\r\n}\r\n\r\nexport function isEmpty(input: any) {\r\n    return !Boolean(input) || String(input).length === 0;\r\n}\r\n\r\nexport const splashScreenLayoutObj: InputLayoutType = {\r\n    layoutId: 0,\r\n    path: '',\r\n};\r\n\r\nexport function splashScreenDOM() {\r\n    const mediaItem = document.querySelector('.media--item');\r\n    const newImg = document.createElement('img');\r\n\r\n    newImg.src = new URL('./logo.png', import.meta.url).href;\r\n\r\n    if (mediaItem !== null) {\r\n        mediaItem.insertBefore(newImg, mediaItem.lastElementChild);\r\n    }\r\n\r\n    return newImg;\r\n}\r\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport { DefaultEvents, Emitter, Unsubscribe } from 'nanoevents';\r\nimport {ILayout, initialLayout} from '../Layout';\r\nimport {IMedia} from '../Media';\r\n\r\nexport interface IRegionEvents {\r\n    start: (layout: IRegion) => void;\r\n    end: (layout: IRegion) => void;\r\n}\r\n\r\nexport interface IRegion {\r\n    layout: ILayout;\r\n    id: string;\r\n    regionId: string;\r\n    xml: null | Element;\r\n    mediaObjects: IMedia[];\r\n    mediaObjectsActions: String[];\r\n    currentMedia: number;\r\n    complete: boolean;\r\n    containerName: string;\r\n    ending: boolean;\r\n    ended: boolean;\r\n    oneMedia: boolean;\r\n    oldMedia: IMedia | undefined;\r\n    curMedia: IMedia | undefined;\r\n    nxtMedia: IMedia | undefined;\r\n    currentMediaIndex: number;\r\n    totalMediaObjects: number;\r\n    ready: boolean;\r\n    options: {\r\n        [k: string]: any;\r\n    };\r\n    sWidth: number;\r\n    sHeight: number;\r\n    offsetX: number;\r\n    offsetY: number;\r\n    zIndex: number;\r\n    index: number;\r\n    emitter?: Emitter<DefaultEvents>;\r\n    prepareRegion(): void;\r\n    playNextMedia(): void;\r\n    transitionNodes(oldMedia: IMedia | undefined, newMedia: IMedia | undefined): void;\r\n    finished(): void;\r\n    run(): void;\r\n    end(): void;\r\n    exitTransition(): void;\r\n    exitTransitionComplete(): void;\r\n    on<E extends keyof IRegionEvents>(event: E, callback: IRegionEvents[E]): Unsubscribe;\r\n    prepareMediaObjects(): void;\r\n}\r\n\r\nexport const initialRegion: IRegion = {\r\n    layout: initialLayout,\r\n    id: '',\r\n    regionId: '',\r\n    xml: null,\r\n    mediaObjects: [],\r\n    mediaObjectsActions: [],\r\n    currentMedia: -1,\r\n    complete: false,\r\n    containerName: '',\r\n    ending: false,\r\n    ended: false,\r\n    oneMedia: false,\r\n    oldMedia: undefined,\r\n    curMedia: undefined,\r\n    nxtMedia: undefined,\r\n    currentMediaIndex: 0,\r\n    totalMediaObjects: 0,\r\n    ready: false,\r\n    options: {},\r\n    sWidth: 0,\r\n    sHeight: 0,\r\n    offsetX: 0,\r\n    offsetY: 0,\r\n    zIndex: 0,\r\n    index: -1,\r\n    prepareRegion() {\r\n    },\r\n    playNextMedia() {\r\n    },\r\n    transitionNodes() {\r\n    },\r\n    finished() {\r\n    },\r\n    run() {\r\n    },\r\n    end() {\r\n    },\r\n    exitTransition() {},\r\n    exitTransitionComplete() {},\r\n    on<E extends keyof IRegionEvents>(event: E, callback: IRegionEvents[E]): Unsubscribe {\r\n        return <Unsubscribe>{};\r\n    },\r\n    prepareMediaObjects() {\r\n    },\r\n};\r\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport { DefaultEvents, Emitter, Unsubscribe } from 'nanoevents';\r\nimport { IMediaEvents } from '../../Modules/Media/Media';\r\nimport {initialRegion, IRegion} from '../Region';\r\n\r\nexport interface IMedia {\r\n    region: IRegion;\r\n    xml: null | Element;\r\n    id: string;\r\n    idCounter: number;\r\n    index: number;\r\n    containerName: string;\r\n    html: null | HTMLElement;\r\n    iframe: null | HTMLIFrameElement;\r\n    iframeName: string;\r\n    mediaType: string;\r\n    render: string;\r\n    attachedAudio: boolean;\r\n    singlePlay: boolean;\r\n    timeoutId: ReturnType<typeof setTimeout>;\r\n    ready: boolean;\r\n    checkIframeStatus: boolean;\r\n    loadIframeOnRun: boolean;\r\n    tempSrc: string;\r\n    finished: boolean;\r\n    schemaVersion: string;\r\n    type: string;\r\n    duration: number;\r\n    useDuration: boolean;\r\n    fileId: string;\r\n    uri: string;\r\n    options: {\r\n        [k: string]: any;\r\n    };\r\n    divWidth: number;\r\n    divHeight: number;\r\n    url: string | null;\r\n    loop: boolean;\r\n    emitter?: Emitter<DefaultEvents>;\r\n    run(): void;\r\n    init(): void;\r\n    stop(): Promise<void>;\r\n    on<E extends keyof IMediaEvents>(event: E, callback: IMediaEvents[E]): Unsubscribe;\r\n}\r\n\r\nexport const initialMedia: IMedia = {\r\n    region: initialRegion,\r\n    xml: null,\r\n    id: '',\r\n    index: 0,\r\n    idCounter: 0,\r\n    containerName: '',\r\n    html: null,\r\n    iframe: null,\r\n    iframeName: '',\r\n    mediaType: '',\r\n    render: 'html',\r\n    attachedAudio: false,\r\n    singlePlay: false,\r\n    timeoutId: setTimeout(() => {}, 100),\r\n    ready: true,\r\n    checkIframeStatus: false,\r\n    loadIframeOnRun: false,\r\n    tempSrc: '',\r\n    finished: false,\r\n    schemaVersion: '1',\r\n    type: '',\r\n    duration: 0,\r\n    useDuration: Boolean(0),\r\n    fileId: '',\r\n    uri: '',\r\n    options: {},\r\n    divWidth: 0,\r\n    divHeight: 0,\r\n    url: null,\r\n    loop: false,\r\n    run() {},\r\n    init() {},\r\n    stop() {\r\n        return Promise.resolve();\r\n    },\r\n    on<E extends keyof IMediaEvents>(event: E, callback: IMediaEvents[E]): Unsubscribe {\r\n        return <Unsubscribe>{};\r\n    },\r\n}\r\n","/*\n * Copyright (C) 2024 Xibo Signage Ltd\n *\n * Xibo - Digital Signage - https://www.xibosignage.com\n *\n * This file is part of Xibo.\n *\n * Xibo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n *\n * Xibo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\n */\nexport const defaultTrans = (duration: number, trans: 'in' | 'out') => {\n    const defaultKeyframes = [\n        { display: trans === 'in' ? 'none' : 'block' },\n        { display: trans === 'out' ? 'none' : 'block' },\n    ];\n    const defaultTiming: number | KeyframeAnimationOptions | undefined = {\n        duration,\n    };\n\n    return {\n        keyframes: defaultKeyframes,\n        timing: defaultTiming,\n    };\n};\n\nexport const fadeInElem = (duration: number) => {\n    const fadeInKeyframes = [\n        { opacity: 0 },\n        { opacity: 1 },\n    ];\n    const fadeInTiming: number | KeyframeAnimationOptions | undefined = {\n        duration,\n        fill: 'forwards',\n    };\n\n    return {\n        keyframes: fadeInKeyframes,\n        timing: fadeInTiming,\n    }\n};\n\nexport const fadeOutElem = (duration: number) => {\n    const fadeOutKeyframes = [\n        { opacity: 1 },\n        { opacity: 0, zIndex: -1 },\n    ];\n    const fadeOutTiming: number | KeyframeAnimationOptions | undefined = {\n        duration,\n        fill: 'forwards',\n    };\n\n    return {\n        keyframes: fadeOutKeyframes,\n        timing: fadeOutTiming,\n    }\n};\n\nexport type KeyframeOptionsType = {\n    from: {\n        [k: string]: any,\n    },\n    to: {\n        [k: string]: any,\n    },\n}\n\nexport const flyInElem = (duration: number, keyframeOptions: KeyframeOptionsType | undefined, direction?: string) => {\n    const flyInKeyframes = [\n        {opacity: 0},\n        {opacity: 1, zIndex: 1},\n    ];\n    const flyInTiming: number | KeyframeAnimationOptions | undefined = {\n        duration,\n        fill: 'forwards',\n    };\n\n    if (keyframeOptions && Boolean(keyframeOptions.from)) {\n        flyInKeyframes[0] = {...keyframeOptions.from, ...flyInKeyframes[0]};\n    }\n\n    if (keyframeOptions && Boolean(keyframeOptions.to)) {\n        flyInKeyframes[1] = {...keyframeOptions.to, ...flyInKeyframes[1]};\n    }\n\n    return {\n        keyframes: flyInKeyframes,\n        timing: flyInTiming,\n    };\n};\n\nexport const flyOutElem = (duration: number, keyframeOptions: KeyframeOptionsType | undefined, direction?: string) => {\n    const flyOutKeyframes: Keyframe[] = [\n        {opacity: 1},\n        {opacity: 0, zIndex: -1},\n    ];\n    const flyOutTiming: number | KeyframeAnimationOptions | undefined = {\n        duration,\n        fill: 'forwards',\n    };\n\n    if (keyframeOptions && Boolean(keyframeOptions.from)) {\n        flyOutKeyframes[0] = {...keyframeOptions.from, ...flyOutKeyframes[0]};\n    }\n\n    if (keyframeOptions && Boolean(keyframeOptions.to)) {\n        flyOutKeyframes[1] = {...keyframeOptions.to, ...flyOutKeyframes[1]};\n    }\n\n    return {\n        keyframes: flyOutKeyframes,\n        timing: flyOutTiming,\n    };\n};\n\nexport type TransitionNameType = 'fadeIn' | 'fadeOut' | 'flyIn' | 'flyOut' | 'defaultIn' | 'defaultOut';\n\nexport type TransitionElementOptions = {\n    duration: number;\n    keyframes?: KeyframeOptionsType;\n    direction?: string;\n};\n\nexport const transitionElement = (transition: TransitionNameType, options: TransitionElementOptions) => {\n    const transitions = {\n        fadeIn: fadeInElem(options.duration),\n        fadeOut: fadeOutElem(options.duration),\n        flyIn: flyInElem(options.duration, options.keyframes, options.direction),\n        flyOut: flyOutElem(options.duration, options.keyframes, options.direction),\n        defaultIn: defaultTrans(options.duration, 'in'),\n        defaultOut: defaultTrans(options.duration, 'out'),\n    };\n\n    return transitions[transition];\n};\n\nexport type compassPoints = 'N' | 'NE' | 'E' | 'SE' | 'S' | 'SW' | 'W' | 'NW';\n\nexport type flyTransitionParams = {\n    trans: 'in' | 'out';\n    direction: compassPoints;\n    height: string | number;\n    width: string | number;\n};\n\nexport const flyTransitionKeyframes = (params: flyTransitionParams): KeyframeOptionsType => {\n    const keyframes = {\n        from: {},\n        to: {},\n    };\n    const opacityAttr = (source: 'from' | 'to') => {\n        if (source === 'from') {\n            return params.trans === 'in' ? 0 : 1;\n        }\n        \n        return params.trans === 'out' ? 1 : 0;\n    };\n\n    switch (params.direction) {\n        case 'N':\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                top: params.trans === 'in' ? `${params.height}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                top: params.trans === 'in' ? 0 : `-${params.height}px`,\n            };\n            break;\n        case 'NE':\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                top: params.trans === 'in' ? `${params.height}px` : 0,\n                left: params.trans === 'in' ? `-${params.width}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                top: params.trans === 'in' ? 0 : `-${params.height}px`,\n                left: params.trans === 'in' ? 0 : `${params.width}px`,\n            };\n            break;\n        case 'E':\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                left: params.trans === 'in' ? `-${params.width}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                left: params.trans === 'in' ? 0 : `${params.width}px`,\n            };\n            break;\n        case 'SE':\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                top: params.trans === 'in' ? `-${params.height}px` : 0,\n                left: params.trans === 'in' ? `-${params.width}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                top: params.trans === 'in' ? 0 : `${params.height}px`,\n                left: params.trans === 'in' ? 0 : `${params.width}px`,\n            };\n            break;\n        case 'S':\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                top: params.trans === 'in' ? `-${params.height}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                top: params.trans === 'in' ? 0 : `${params.height}px`,\n            };\n            break;\n        case 'SW':\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                top: params.trans === 'in' ? `-${params.height}px` : 0,\n                left: params.trans === 'in' ? `${params.width}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                top: params.trans === 'in' ? 0 : `${params.height}px`,\n                left: params.trans === 'in' ? 0 : `-${params.width}px`,\n            };\n            break;\n        case 'W':\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                left: params.trans === 'in' ? `${params.width}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                left: params.trans === 'in' ? 0 : `-${params.width}px`,\n            };\n            break;\n        case 'NW':\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                top: params.trans === 'in' ? `${params.height}px` : 0,\n                left: params.trans === 'in' ? `${params.width}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                top: params.trans === 'in' ? 0 : `-${params.height}px`,\n                left: params.trans === 'in' ? 0 : `-${params.width}px`,\n            };\n            break;\n        default:\n            keyframes.from = {\n                opacity: opacityAttr('from'),\n                top: params.trans === 'in' ? `${params.height}px` : 0,\n            };\n            keyframes.to = {\n                opacity: opacityAttr('to'),\n                top: params.trans === 'in' ? 0 : `-${params.height}px`,\n            };\n            break;\n    }\n\n    return keyframes;\n};\n","/*\n * Copyright (C) 2024 Xibo Signage Ltd\n *\n * Xibo - Digital Signage - https://www.xibosignage.com\n *\n * This file is part of Xibo.\n *\n * Xibo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n *\n * Xibo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\n */\nimport { IMedia } from '../../Types/Media';\nimport { capitalizeStr, getMediaId } from '../Generators';\n\nexport default function VideoMedia(media: IMedia) {\n    const videoMediaObject = {\n        init() {\n            const $videoMedia = document.getElementById(getMediaId(media)) as HTMLVideoElement;\n\n            if ($videoMedia) {\n                $videoMedia.onloadstart = () => {\n                    console.debug(`${capitalizeStr(media.mediaType)} for media > ${media.id} has started loading data . . .`);\n                };\n                $videoMedia.onloadeddata = () => {\n                    if ($videoMedia.readyState >= 2) {\n                        console.debug(`${capitalizeStr(media.mediaType)} data for media > ${media.id} has been fully loaded . . .`);\n                    }\n                };\n                $videoMedia.oncanplay = () => {\n                    console.debug(`${capitalizeStr(media.mediaType)} for media > ${media.id} can be played . . .`);\n        \n                    const videoPlayPromise = $videoMedia.play();\n        \n                    if (videoPlayPromise !== undefined) {\n                        videoPlayPromise.then(() => {\n                            console.debug('autoplay started . . .');\n                            // Autoplay restarted\n                        }).catch(error => {\n                            $videoMedia.muted = true;\n                            $videoMedia.play();\n                        });\n                    }\n                };\n                $videoMedia.onplaying = () => {\n                    console.debug(`${capitalizeStr(media.mediaType)} for media > ${media.id} is now playing . . .`);\n                };\n\n                if (media.duration === 0) {\n                    $videoMedia.ondurationchange = () => {\n                        console.debug('Showing Media ' + media.id + ' for ' + $videoMedia.duration + 's of Region ' + media.region.regionId);\n                    };\n                    $videoMedia.onended = () => {\n                        console.debug(`${capitalizeStr(media.mediaType)} for media > ${media.id} has ended playing . . .`);\n                        media.emitter?.emit('end', media);\n                    };\n                }\n            }\n        }\n    }\n\n    return videoMediaObject;\n}\n","/*\n * Copyright (C) 2024 Xibo Signage Ltd\n *\n * Xibo - Digital Signage - https://www.xibosignage.com\n *\n * This file is part of Xibo.\n *\n * Xibo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n *\n * Xibo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\n */\nimport { IMedia } from '../../Types/Media';\nimport { capitalizeStr, getMediaId } from '../Generators';\n\nimport './media.css';\n\nexport default function AudioMedia(media: IMedia) {\n    const audioMediaObject = {\n        init() {\n            const $audioMedia = document.getElementById(getMediaId(media)) as HTMLAudioElement;\n            let $playBtn: HTMLButtonElement | null = null;\n\n            if ($audioMedia) {\n                $audioMedia.onloadstart = () => {\n                    console.debug(`${capitalizeStr(media.mediaType)} for media > ${media.id} has started loading data . . .`);\n                };\n                $audioMedia.onloadeddata = () => {\n                    if ($audioMedia.readyState >= 2) {\n                        console.debug(`${capitalizeStr(media.mediaType)} data for media > ${media.id} has been fully loaded . . .`);\n                    }\n                };\n                $audioMedia.oncanplay = () => {\n                    console.debug(`${capitalizeStr(media.mediaType)} for media > ${media.id} can be played . . .`);\n                };\n                $audioMedia.onplaying = () => {\n                    console.debug(`${capitalizeStr(media.mediaType)} for media > ${media.id} is now playing . . .`);\n\n                    if ($playBtn !== null) {\n                        $playBtn.remove();\n                    }\n                };\n\n                const audioPlayPromise = $audioMedia.play();\n    \n                if (audioPlayPromise !== undefined) {\n                    audioPlayPromise.then(() => {\n                        console.debug('autoplay started . . .');\n                        // Autoplay restarted\n                    }).catch(error => {\n                        if (error.name === 'NotAllowedError') {\n                            // Let's show a play audio button\n                            $playBtn = document.createElement('button');\n\n                            $playBtn.classList.add('play-audio-btn');\n                            $playBtn.textContent = 'Play Audio';\n                            $playBtn.addEventListener('click', () => {\n                                $audioMedia.muted = false;\n                                $audioMedia.play();\n                            });\n                            $audioMedia.parentNode?.insertBefore($playBtn, $audioMedia.nextSibling);\n                        }\n                    });\n                }\n                if (media.duration === 0) {\n                    $audioMedia.ondurationchange = () => {\n                        console.debug('Showing Media ' + media.id + ' for ' + $audioMedia.duration + 's of Region ' + media.region.regionId);\n                    };\n                    $audioMedia.onended = () => {\n                        console.debug(`${capitalizeStr(media.mediaType)} for media > ${media.id} has ended playing . . .`);\n                        media.emitter?.emit('end', media);\n                    };\n                }\n            }\n        },\n    };\n\n    return audioMediaObject;\n}\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport { createNanoEvents } from 'nanoevents';\r\nimport { OptionsType } from '../../Types/Layout';\r\nimport { IRegion } from '../../Types/Region';\r\nimport { IMedia, initialMedia } from '../../Types/Media';\r\nimport { fetchJSON, getMediaId, nextId, preloadMediaBlob } from '../Generators';\r\nimport { TransitionElementOptions, compassPoints, flyTransitionKeyframes, transitionElement } from '../Transitions';\r\nimport VideoMedia from './VideoMedia';\r\nimport AudioMedia from './AudioMedia';\r\nimport {composeResourceUrlByPlatform, getDataBlob} from '../Generators/Generators';\r\nimport {IXlr} from '../../Types/XLR';\r\nimport {PreviewSplashElement} from '../SplashScreen/SplashScreen';\r\n\r\nexport interface IMediaEvents {\r\n    start: (media: IMedia) => void;\r\n    end: (media: IMedia) => void;\r\n}\r\n\r\nexport default function Media(\r\n    region: IRegion,\r\n    mediaId: string,\r\n    xml: Element,\r\n    options: OptionsType,\r\n    xlr: IXlr,\r\n) {\r\n    const props = {\r\n        region: region,\r\n        mediaId: mediaId,\r\n        xml: xml,\r\n        options: options,\r\n    };\r\n    let mediaTimer: string | number | NodeJS.Timeout | null | undefined = null;\r\n    let mediaTimeCount = 0;\r\n    const emitter = createNanoEvents<IMediaEvents>();\r\n    const mediaObject: IMedia = {\r\n        ...initialMedia,\r\n        ...props,\r\n    };\r\n    const startMediaTimer = (media: IMedia) => {\r\n        mediaTimer = setInterval(() => {\r\n            mediaTimeCount++;\r\n            if (mediaTimeCount > media.duration) {\r\n                media.emitter?.emit('end', media);\r\n            }\r\n        }, 1000);\r\n        const $splashScreen = document.querySelector('.preview-splash') as PreviewSplashElement;\r\n        if ($splashScreen !== null && $splashScreen.style.display === 'block') {\r\n            $splashScreen?.hide();\r\n        }\r\n\r\n        console.debug('Showing Media ' + media.id + ' for ' + media.duration + 's of Region ' + media.region.regionId);\r\n    };\r\n\r\n    emitter.on('start', function(media) {\r\n        if (media.mediaType === 'video') {\r\n            VideoMedia(media).init();\r\n\r\n            if (media.duration > 0) {\r\n                startMediaTimer(media);\r\n            }\r\n        } else if (media.mediaType === 'audio') {\r\n            AudioMedia(media).init();\r\n            if (media.duration > 0) {\r\n                startMediaTimer(media);\r\n            }\r\n        } else {\r\n            startMediaTimer(media);\r\n        }\r\n    });\r\n\r\n    emitter.on('end', function(media) {\r\n        if (mediaTimer) {\r\n            clearInterval(mediaTimer);\r\n            mediaTimeCount = 0;\r\n        }\r\n\r\n        media.region.playNextMedia();\r\n    });\r\n\r\n    mediaObject.init = function() {\r\n        const self = mediaObject;\r\n        self.id = props.mediaId;\r\n        self.fileId = self.xml?.getAttribute('fileId') || '';\r\n        self.idCounter = nextId(props.options);\r\n        self.containerName = `M-${self.id}-${self.idCounter}`;\r\n        self.iframeName = `${self.containerName}-iframe`;\r\n        self.mediaType = self.xml?.getAttribute('type') || '';\r\n        self.render = self.xml?.getAttribute('render') || '';\r\n        self.duration = parseInt(self.xml?.getAttribute('duration') as string) || 0;\r\n        self.options = { ...props.options, mediaId };\r\n\r\n        const $mediaIframe = document.createElement('iframe');\r\n        const mediaOptions = self.xml?.getElementsByTagName('options');\r\n\r\n        if (mediaOptions) {\r\n            for (let _options of Array.from(mediaOptions)) {\r\n                // Get options\r\n                const _mediaOptions = _options.children;\r\n                for (let mediaOption of Array.from(_mediaOptions)) {\r\n                    self.options[mediaOption.nodeName.toLowerCase()] = mediaOption.textContent;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check for options.uri and add it to media\r\n        if (Boolean(self.options['uri'])) {\r\n            self.uri = self.options['uri'];\r\n        }\r\n\r\n        // Show in fullscreen?\r\n        if(self.options.showfullscreen === \"1\") {\r\n            // Set dimensions as the layout ones\r\n            self.divWidth = self.region.layout.sWidth;\r\n            self.divHeight = self.region.layout.sHeight;\r\n        } else {\r\n            // Set dimensions as the region ones\r\n            self.divWidth = self.region.sWidth;\r\n            self.divHeight = self.region.sHeight;\r\n        }\r\n\r\n        $mediaIframe.scrolling = 'no';\r\n        $mediaIframe.id = self.iframeName;\r\n        $mediaIframe.width = `${self.divWidth}px`;\r\n        $mediaIframe.height = `${self.divHeight}px`;\r\n        $mediaIframe.style.cssText = `border: 0; visibility: hidden;`;\r\n\r\n        const $mediaId = getMediaId(self);\r\n        let $media = document.getElementById($mediaId);\r\n\r\n        if ($media === null) {\r\n            if (self.mediaType === 'video') {\r\n                $media = document.createElement('video');\r\n            } else if (self.mediaType === 'audio') {\r\n                $media = new Audio();\r\n            } else {\r\n                $media = document.createElement('div');\r\n            }\r\n        \r\n            $media.id = $mediaId;\r\n        }\r\n\r\n        $media.className = 'media--item';\r\n\r\n        /* Scale the Content Container */\r\n        $media.style.cssText = `\r\n            display: none;\r\n            width: ${self.divWidth}px;\r\n            height: ${self.divHeight}px;\r\n            position: absolute;\r\n            background-size: contain;\r\n            background-repeat: no-repeat;\r\n            background-position: center;\r\n        `;\r\n\r\n        const $region = document.getElementById(`${self.region.containerName}`);\r\n\r\n        const resourceUrlParams: any = {\r\n            ...xlr.config.config,\r\n            regionOptions: self.region.options,\r\n            layoutId: self.region.layout.layoutId,\r\n            regionId: self.region.id,\r\n            mediaId: self.id,\r\n            fileId: self.fileId,\r\n            scaleFactor: self.region.layout.scaleFactor,\r\n            uri: self.uri,\r\n        };\r\n\r\n        if (self.mediaType === 'image' || self.mediaType === 'video') {\r\n            resourceUrlParams.mediaType = self.mediaType;\r\n        }\r\n\r\n        const tmpUrl = composeResourceUrlByPlatform(xlr.config.platform, resourceUrlParams);\r\n\r\n        self.url = tmpUrl;\r\n\r\n        // Loop if media has loop, or if region has loop and a single media\r\n        self.loop =\r\n            self.options['loop'] == '1' ||\r\n            (self.region.options['loop'] == '1' && self.region.totalMediaObjects == 1);\r\n\r\n        $mediaIframe.src = `${tmpUrl}&width=${self.divWidth}&height=${self.divHeight}`;\r\n\r\n        if (self.render === 'html' || self.mediaType === 'ticker' || self.mediaType === 'webpage') {\r\n            self.checkIframeStatus = true;\r\n            self.iframe = $mediaIframe;\r\n        }  else if (self.mediaType === \"image\") {\r\n            // preload.addFiles(tmpUrl);\r\n            // $media.style.cssText = $media.style.cssText.concat(`background-image: url('${tmpUrl}');`);\r\n            if (self.options['scaletype'] === 'stretch') {\r\n                $media.style.cssText = $media.style.cssText.concat(`background-size: 100% 100%;`);\r\n            } else if (self.options['scaletype'] === 'fit') {\r\n                $media.style.cssText = $media.style.cssText.concat(`background-size: cover;`);\r\n            } else {\r\n                // Center scale type, do we have align or valign?\r\n                const align = (self.options['align'] == \"\") ? \"center\" : self.options['align'];\r\n                const valign = (self.options['valign'] == \"\" || self.options['valign'] == \"middle\") ? \"center\" : self.options['valign'];\r\n                $media.style.cssText = $media.style.cssText.concat(`background-position: ${align} ${valign}`);\r\n            }\r\n        } else if (self.mediaType === 'video') {\r\n            const $videoMedia = $media as HTMLVideoElement;\r\n\r\n            $videoMedia.preload = 'auto';\r\n            $videoMedia.textContent = 'Unsupported Video';\r\n\r\n            if (Boolean(self.options['mute'])) {\r\n                $videoMedia.muted = self.options.mute === '1';\r\n            }\r\n\r\n            if (Boolean(self.options['scaletype'])) {\r\n                if (self.options.scaletype === 'stretch') {\r\n                    $videoMedia.style.objectFit = 'fill';\r\n                }\r\n            }\r\n            $videoMedia.playsInline = true;\r\n\r\n            if (self.loop) {\r\n                $videoMedia.loop = true;\r\n            }\r\n\r\n            $media = $videoMedia;\r\n        } else if (self.mediaType === 'audio') {\r\n            const $audioMedia = $media as HTMLAudioElement;\r\n\r\n            $audioMedia.preload = 'auto';\r\n            $audioMedia.textContent = 'Unsupported Audio';\r\n            $audioMedia.autoplay = true;\r\n\r\n            if (self.loop) {\r\n                $audioMedia.loop = true;\r\n            }\r\n\r\n            $media = $audioMedia;\r\n        }\r\n\r\n        // Duration is per item condition\r\n        if (self.render === 'html' || self.mediaType === 'ticker') {\r\n            /* Check if the ticker duration is based on the number of items in the feed */\r\n            if (self.options['durationisperitem'] === '1') {\r\n                const regex = new RegExp('<!-- NUMITEMS=(.*?) -->');\r\n\r\n                (async () => {\r\n                    let html = await fetchJSON(`${tmpUrl}&width=${self.divWidth}&height=${self.divHeight}`);\r\n                    console.debug({html});\r\n                    const res = regex.exec(html);\r\n\r\n                    if (res !== null) {\r\n                        self.duration = parseInt(String(self.duration)) * parseInt(res[1]);\r\n                    }\r\n                })();\r\n            }\r\n        }\r\n\r\n        // Check if the media has fade-in/out transitions\r\n        if (Boolean(self.options['transin']) && Boolean(self.options['transinduration'])) {\r\n            const transInDuration = Number(self.options.transinduration);\r\n            const fadeInTrans = transitionElement('fadeIn', { duration: transInDuration });\r\n            $media.animate(fadeInTrans.keyframes, fadeInTrans.timing);\r\n        }\r\n\r\n        // Add media to the region\r\n        // Second media if exists, will be off-canvas\r\n        // All added media will be hidden by default\r\n        // It will start showing when region.nextMedia() function is called\r\n\r\n        // When there's only 1 item and loop = false, don't remove the item but leave it at its last state\r\n        // For image, and only 1 item, it should still have the transition for next state\r\n        // Add conditions for video duration being 0 or 1 and also the loop property\r\n        // For video url, we have to create a URL out of the XLF video URL\r\n\r\n        /**\r\n         * @DONE\r\n         * Case 1: Video duration = 0, this will play the video for its entire duration\r\n         * Case 2: Video duration is set > 0 and loop = false\r\n         * E.g. Set duration = 100s, video duration = 62s\r\n         * the video will play until 62s and will stop to its last frame until 100s\r\n         * After 100s, it will expire\r\n         * Case 3: Video duration is set > 0 and loop = true\r\n         * E.g. Set duration = 100s, video duration = 62s, loop = true\r\n         * the video will play until 62s and will loop through until the remaining 38s\r\n         * to complete the 100s set duration\r\n         */\r\n\r\n        // Add html node to media for\r\n        self.html = $media;\r\n        // Check/set iframe based widgets play status\r\n    };\r\n\r\n    mediaObject.run = function() {\r\n        const self = mediaObject;\r\n        let transInDuration = 1;\r\n        let transInDirection: compassPoints = 'E';\r\n\r\n        if (Boolean(self.options['transinduration'])) {\r\n            transInDuration = Number(self.options.transinduration);\r\n        }\r\n\r\n        if (Boolean(self.options['transindirection'])) {\r\n            transInDirection = self.options.transindirection;\r\n        }\r\n\r\n        let defaultTransInOptions: TransitionElementOptions = {duration: transInDuration};\r\n        let transIn = transitionElement('defaultIn', {duration: defaultTransInOptions.duration});\r\n        \r\n        if (Boolean(self.options['transin'])) {\r\n            let transInName = self.options['transin'];\r\n\r\n            if (transInName === 'fly') {\r\n                transInName = `${transInName}In`;\r\n                defaultTransInOptions.keyframes = flyTransitionKeyframes({\r\n                    trans: 'in',\r\n                    direction: transInDirection,\r\n                    height: self.divHeight,\r\n                    width: self.divWidth,\r\n                });\r\n            }\r\n\r\n            transIn = transitionElement(transInName, defaultTransInOptions);\r\n        }\r\n\r\n        const showCurrentMedia = async () => {\r\n            let $mediaId = getMediaId(self);\r\n            let $media = document.getElementById($mediaId);\r\n            const isCMS = xlr.config.platform === 'CMS';\r\n\r\n            if ($media === null) {\r\n                $media = getNewMedia();\r\n            }\r\n\r\n            if ($media !== null) {\r\n                $media.style.setProperty('display', 'block');\r\n\r\n                if (Boolean(self.options['transin'])) {\r\n                    $media.animate(transIn.keyframes, transIn.timing);\r\n                }\r\n\r\n                if (self.mediaType === 'image' && self.url !== null) {\r\n                    ($media as HTMLImageElement).style\r\n                        .setProperty(\r\n                            'background-image',\r\n                            `url(${!isCMS ? self.url : await getDataBlob(self.url)}`\r\n                        );\r\n                } else if (self.mediaType === 'video' && self.url !== null) {\r\n                    ($media as HTMLVideoElement).src =\r\n                        isCMS ? await preloadMediaBlob(self.url, self.mediaType) : self.url;\r\n                } else if (self.mediaType === 'audio' && self.url !== null) {\r\n                    ($media as HTMLAudioElement).src =\r\n                        isCMS ? await preloadMediaBlob(self.url, self.mediaType) : self.url;\r\n                } else if ((self.render === 'html' || self.mediaType === 'webpage') &&\r\n                    self.iframe && self.checkIframeStatus\r\n                ) {\r\n                    // Set state as false ( for now )\r\n                    self.ready = false;\r\n\r\n                    // Append iframe\r\n                    $media.innerHTML = '';\r\n                    $media.appendChild(self.iframe as Node);\r\n\r\n                    // On iframe load, set state as ready to play full preview\r\n                    (self.iframe) && self.iframe.addEventListener('load', function(){\r\n                        self.ready = true;\r\n                        if (self.iframe) {\r\n                            const iframeStyles = self.iframe.style.cssText;\r\n                            self.iframe.style.cssText = iframeStyles?.concat('visibility: visible;');\r\n                        }\r\n                    });\r\n                }\r\n\r\n                self.emitter?.emit('start', self);\r\n            }\r\n        };\r\n        const getNewMedia = (): HTMLElement | null => {\r\n            const $region = document.getElementById(`${self.region.containerName}`);\r\n            // This function is for checking whether\r\n            // the region still has to show a media item\r\n            // when another region is not finished yet\r\n            if (self.region.complete && !self.region.layout.allEnded) {\r\n                // Add currentMedia to the region\r\n\r\n                ($region) && $region.insertBefore(self.html as Node, $region.lastElementChild);\r\n\r\n                return self.html as HTMLElement;\r\n            }\r\n\r\n            return null;\r\n        };\r\n\r\n        showCurrentMedia();\r\n    };\r\n\r\n    mediaObject.stop = async function() {\r\n        const self = mediaObject;\r\n        const $media = document.getElementById(getMediaId(self));\r\n\r\n        if ($media) {\r\n            $media.style.display = 'none';\r\n            $media.remove();\r\n        }\r\n    };\r\n\r\n    \r\n    mediaObject.on = function<E extends keyof IMediaEvents>(event: E, callback: IMediaEvents[E]) {\r\n        return emitter.on(event, callback);\r\n    };\r\n\r\n    mediaObject.emitter = emitter;\r\n\r\n    mediaObject.init();\r\n\r\n    return mediaObject;\r\n}","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport { createNanoEvents } from 'nanoevents';\r\nimport { ILayout, OptionsType } from '../../Types/Layout';\r\nimport { initialRegion, IRegion, IRegionEvents } from '../../Types/Region';\r\nimport { IMedia } from '../../Types/Media';\r\nimport { getMediaId, nextId } from '../Generators';\r\nimport { platform } from '../Platform';\r\nimport { Media } from '../Media';\r\nimport {\r\n    TransitionElementOptions,\r\n    TransitionNameType,\r\n    compassPoints,\r\n    flyTransitionKeyframes,\r\n    transitionElement,\r\n} from '../Transitions';\r\nimport {IXlr} from '../../Types/XLR';\r\n\r\nexport default function Region(\r\n    layout: ILayout,\r\n    xml: Element,\r\n    regionId: string,\r\n    options: OptionsType,\r\n    xlr: IXlr,\r\n) {\r\n    const props = {\r\n        layout: layout,\r\n        xml: xml,\r\n        regionId: regionId,\r\n        options: options,\r\n    }\r\n    const emitter = createNanoEvents<IRegionEvents>();\r\n    let regionObject: IRegion = {\r\n        ...initialRegion,\r\n        ...props,\r\n    };\r\n\r\n    regionObject.prepareRegion = function() {\r\n        const self = regionObject;\r\n        const {layout, options} = self;\r\n        self.id = props.regionId;\r\n        self.options = {...platform, ...props.options};\r\n        self.containerName = `R-${self.id}-${nextId(self.options as OptionsType & IRegion[\"options\"])}`;\r\n        self.xml = props.xml;\r\n        self.mediaObjects = [];\r\n\r\n        self.sWidth = (self.xml) && Number(self.xml?.getAttribute('width')) * layout.scaleFactor;\r\n        self.sHeight = (self.xml) && Number(self.xml?.getAttribute('height')) * layout.scaleFactor;\r\n        self.offsetX = (self.xml) && Number(self.xml?.getAttribute('left')) * layout.scaleFactor;\r\n        self.offsetY = (self.xml) && Number(self.xml?.getAttribute('top')) * layout.scaleFactor;\r\n        self.zIndex = (self.xml) && Number(self.xml?.getAttribute('zindex'));\r\n        \r\n        const regionOptions = self.xml?.getElementsByTagName('options');\r\n\r\n        if (regionOptions) {\r\n            for (let _options of Array.from(regionOptions)) {\r\n                // Get options\r\n                const _regionOptions = _options.children;\r\n                for (let regionOption of Array.from(_regionOptions)) {\r\n                    self.options[regionOption.nodeName.toLowerCase()] = regionOption.textContent;\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        let $region = document.getElementById(self.containerName);\r\n        const $layout = document.getElementById(`${self.layout.containerName}`);\r\n\r\n        if ($region === null) {\r\n            $region = document.createElement('div');\r\n            $region.id = self.containerName;\r\n        }\r\n\r\n        ($layout) && $layout.appendChild($region);\r\n\r\n        /* Scale the Layout Container */\r\n        /* Add region styles */\r\n        $region.style.cssText = `\r\n            width: ${self.sWidth}px;\r\n            height: ${self.sHeight}px;\r\n            position: absolute;\r\n            left: ${self.offsetX}px;\r\n            top: ${self.offsetY}px;\r\n            z-index: ${Math.round(self.zIndex)};\r\n        `;\r\n        $region.className = 'region--item';\r\n\r\n        /* Parse region media objects */\r\n        const regionMediaItems = Array.from(self.xml.getElementsByTagName('media'));\r\n        self.totalMediaObjects = regionMediaItems.length;\r\n\r\n        Array.from(regionMediaItems).forEach((mediaXml, indx) => {\r\n            const mediaObj = Media(\r\n                self,\r\n                mediaXml?.getAttribute('id') || '',\r\n                mediaXml,\r\n                options as OptionsType & IRegion[\"options\"],\r\n                xlr,\r\n            );\r\n\r\n            mediaObj.index = indx;\r\n            self.mediaObjects.push(mediaObj);\r\n        });\r\n\r\n        self.prepareMediaObjects();\r\n    };\r\n\r\n    regionObject.finished = function() {\r\n        const self = regionObject;\r\n        console.debug('Region::finished called . . . ', self.id);\r\n        // Mark as complete\r\n        self.complete = true;\r\n        self.layout.regions[regionObject.index] = regionObject;\r\n        self.layout.regionExpired();\r\n    };\r\n\r\n    regionObject.prepareMediaObjects = function() {\r\n        const self = regionObject;\r\n        let nextMediaIndex;\r\n\r\n        if (self.mediaObjects.length > 0) {\r\n\r\n            if (self.curMedia) {\r\n                self.oldMedia = self.curMedia;\r\n            } else {\r\n                self.oldMedia = undefined;\r\n            }\r\n\r\n            if (self.currentMediaIndex >= self.mediaObjects.length) {\r\n                self.currentMediaIndex = 0;\r\n            }\r\n\r\n            self.curMedia = self.mediaObjects[self.currentMediaIndex];\r\n\r\n            nextMediaIndex = self.currentMediaIndex + 1;\r\n\r\n            if (nextMediaIndex >= self.mediaObjects.length ||\r\n                (\r\n                    !Boolean(self.mediaObjects[nextMediaIndex]) &&\r\n                    self.mediaObjects.length === 1\r\n                )\r\n            ) {\r\n                nextMediaIndex = 0;\r\n            }\r\n\r\n            if (Boolean(self.mediaObjects[nextMediaIndex])) {\r\n                self.nxtMedia = self.mediaObjects[nextMediaIndex];\r\n            }\r\n\r\n            const $region = document.getElementById(`${self.containerName}`);\r\n            // Append available media to region DOM\r\n            if (self.curMedia) {\r\n                ($region) && $region.insertBefore(self.curMedia.html as Node, $region.lastElementChild);\r\n            }\r\n\r\n            if (self.nxtMedia) {\r\n                ($region) && $region.insertBefore(self.nxtMedia.html as Node, $region.lastElementChild);\r\n            }\r\n        }\r\n    };\r\n\r\n    regionObject.run = function() {\r\n        console.debug('Called Region::run > ', regionObject.id);\r\n\r\n        if (regionObject.curMedia) {\r\n            regionObject.transitionNodes(regionObject.oldMedia, regionObject.curMedia);\r\n        }\r\n    };\r\n\r\n    regionObject.transitionNodes = function(oldMedia: IMedia | undefined, newMedia: IMedia | undefined) {\r\n        const self = regionObject;\r\n        let transOutDuration = 1;\r\n        let transOutDirection: compassPoints = 'E';\r\n\r\n        if (newMedia) {\r\n            if (oldMedia && Boolean(oldMedia.options['transoutduration'])) {\r\n                transOutDuration = Number(oldMedia.options.transoutduration);\r\n            }\r\n\r\n            if (oldMedia && Boolean(oldMedia.options['transoutdirection'])) {\r\n                transOutDirection = oldMedia.options.transoutdirection;\r\n            }\r\n    \r\n            let defaultTransOutOptions: TransitionElementOptions = {duration: transOutDuration};\r\n            let transOut = transitionElement('defaultOut', {duration: defaultTransOutOptions.duration});\r\n    \r\n            let transOutName: TransitionNameType | string;\r\n            if (oldMedia && Boolean(oldMedia.options['transout'])) {\r\n                transOutName = oldMedia.options['transout'];\r\n    \r\n                if (transOutName === 'fly') {\r\n                    transOutName = `${transOutName}Out`;\r\n                    defaultTransOutOptions.keyframes = flyTransitionKeyframes({\r\n                        trans: 'out',\r\n                        direction: transOutDirection,\r\n                        height: oldMedia.divHeight,\r\n                        width: oldMedia.divWidth,\r\n                    });\r\n                }\r\n                \r\n                transOut = transitionElement(transOutName as TransitionNameType, defaultTransOutOptions);\r\n            }\r\n            \r\n            const hideOldMedia = new Promise((resolve) => {\r\n                // Hide oldMedia\r\n                if (oldMedia) {\r\n                    const $oldMedia = document.getElementById(getMediaId(oldMedia));\r\n                    if ($oldMedia) {\r\n                        const removeOldMedia = () => {\r\n                            $oldMedia.style.setProperty('display', 'none');\r\n                            $oldMedia.remove();\r\n                        };\r\n\r\n                        let oldMediaAnimate: any;\r\n                        if (Boolean(oldMedia.options['transout'])) {\r\n                            oldMediaAnimate = $oldMedia.animate(transOut.keyframes, transOut.timing);\r\n                        }\r\n\r\n                        if (Boolean(oldMedia.options['transout']) && self.totalMediaObjects > 1) {\r\n                            if (transOutName === 'flyOut') {\r\n                                // Reset last item to original position and state\r\n                                oldMediaAnimate ? oldMediaAnimate.finished\r\n                                    .then(() => {\r\n                                        resolve(true);\r\n                                        oldMediaAnimate?.effect?.updateTiming({fill: 'none'});\r\n                                        removeOldMedia();\r\n                                    }) : undefined;\r\n                            } else {\r\n                                setTimeout(removeOldMedia, transOutDuration / 2);\r\n                                resolve(true);\r\n                            }\r\n                        } else {\r\n                            removeOldMedia();\r\n                            // Resolve this right away\r\n                            // As a result, the transition between two media object\r\n                            // seems like a cross-over\r\n                            resolve(true);\r\n\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n    \r\n            if (oldMedia) {\r\n                hideOldMedia.then((isDone) => {\r\n                    if (isDone) {\r\n                        newMedia.run();\r\n                    }\r\n                });\r\n            } else {\r\n                newMedia.run();\r\n            }\r\n        }\r\n    };\r\n\r\n    regionObject.playNextMedia = function() {\r\n        const self = regionObject;\r\n\r\n        /* The current media has finished running */\r\n        if (self.ended) {\r\n            return;\r\n        }\r\n\r\n        if (self.currentMediaIndex === self.mediaObjects.length - 1) {\r\n            self.finished();\r\n\r\n            if (self.layout.allEnded) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // When the region has completed and when currentMedia is html\r\n        // Then, preserve the currentMedia state\r\n        if (self.complete &&\r\n            self.curMedia?.render === 'html'\r\n        ) {\r\n            return;\r\n        }\r\n\r\n        // When the region has completed and mediaObjects.length = 1\r\n        // and curMedia.loop = false, then put the media on\r\n        // its current state\r\n        if (self.complete && self.mediaObjects.length === 1 &&\r\n            self.curMedia?.render !== 'html' &&\r\n            self.curMedia?.mediaType === 'image' &&\r\n            !self.curMedia?.loop\r\n        ) {\r\n            return;\r\n        }\r\n\r\n        self.currentMediaIndex = self.currentMediaIndex + 1;\r\n        self.prepareMediaObjects();\r\n\r\n        self.transitionNodes(self.oldMedia, self.curMedia);\r\n    };\r\n    \r\n    regionObject.end = function() {\r\n        const self = regionObject;\r\n        self.ending = true;\r\n        /* The Layout has finished running */\r\n        /* Do any region exit transition then clean up */\r\n        self.layout.regions[self.index] = self;\r\n\r\n        console.debug('Calling Region::end ', self);\r\n        self.exitTransition();\r\n    };\r\n\r\n    regionObject.exitTransition = function() {\r\n        const self = regionObject;\r\n        /* TODO: Actually implement region exit transitions */\r\n        const $region = document.getElementById(`${self.containerName}`);\r\n\r\n        if ($region) {\r\n            $region.style.display = 'none';\r\n        }\r\n\r\n        console.debug('Called Region::exitTransition ', self.id);\r\n\r\n        self.exitTransitionComplete();\r\n    };\r\n\r\n    regionObject.exitTransitionComplete = function() {\r\n        const self = regionObject;\r\n        console.debug('Called Region::exitTransitionComplete ', self.id);\r\n        self.ended = true;\r\n        self.layout.regions[self.index] = self;\r\n        self.layout.regionEnded();\r\n    };\r\n\r\n    regionObject.on = function<E extends keyof IRegionEvents>(event: E, callback: IRegionEvents[E]) {\r\n        return emitter.on(event, callback);\r\n    };\r\n\r\n    regionObject.emitter = emitter;\r\n\r\n    regionObject.prepareRegion();\r\n\r\n    return regionObject;\r\n}","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport {createNanoEvents} from 'nanoevents';\r\nimport {\r\n    GetLayoutParamType,\r\n    GetLayoutType,\r\n    ILayout,\r\n    initialLayout,\r\n    OptionsType,\r\n} from '../../Types/Layout';\r\nimport { IXlr } from '../../Types/XLR';\r\nimport { nextId } from '../Generators';\r\nimport { Region } from '../Region';\r\n\r\nimport './layout.css';\r\nimport {composeBgUrlByPlatform, getIndexByLayoutId} from '../Generators/Generators';\r\n\r\nconst playAgainClickHandle = function(ev: { preventDefault: () => void; }) {\r\n    ev.preventDefault();\r\n    history.go(0);\r\n};\r\n\r\nexport function initRenderingDOM(targetContainer: Element | null) {\r\n    let _targetContainer = targetContainer;\r\n    const previewPlayer = document.createElement('div');\r\n    const previewScreen = document.createElement('div');\r\n    const endPlay = document.createElement('div');\r\n    const playAgainLink = document.createElement('a');\r\n\r\n    // Preview player\r\n    previewPlayer.className = 'player-preview';\r\n    previewPlayer.id = 'player_container';\r\n\r\n    // Preview screen\r\n    previewScreen.className = 'screen-preview';\r\n    previewScreen.id = 'screen_container';\r\n\r\n    // Ended play\r\n    endPlay.className = 'preview-ended';\r\n    endPlay.id = 'play_ended';\r\n    endPlay.style.display = 'none';\r\n\r\n    // Play again link\r\n    playAgainLink.id = 'play_back_preview';\r\n    playAgainLink.className = 'play-back-preview';\r\n    playAgainLink.style.cssText = 'text-decoration: none; color: #ffffff;';\r\n    playAgainLink.innerHTML = 'Play again?';\r\n    playAgainLink.removeEventListener('click', playAgainClickHandle);\r\n    playAgainLink.addEventListener('click', playAgainClickHandle);\r\n\r\n    if (!_targetContainer) {\r\n        _targetContainer = document.body;\r\n    }\r\n\r\n    if (_targetContainer) {\r\n        if (_targetContainer.querySelector('#player_container') === null) {\r\n            _targetContainer.insertBefore(previewPlayer, _targetContainer.firstChild);\r\n\r\n            if (previewPlayer.querySelector('#screen_container') === null) {\r\n                previewPlayer.appendChild(previewScreen);\r\n            }\r\n\r\n            if (previewPlayer.querySelector('#play_ended') === null) {\r\n                previewPlayer.appendChild(endPlay);\r\n\r\n                if (endPlay.querySelector('a') === null) {\r\n                    endPlay.appendChild(playAgainLink);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport async function getXlf(layoutOptions: OptionsType) {\r\n    let apiHost = window.location.origin;\r\n\r\n    let xlfUrl = apiHost + layoutOptions.xlfUrl;\r\n    let fetchOptions: RequestInit = {};\r\n\r\n    if (layoutOptions.platform === 'CMS') {\r\n        xlfUrl = apiHost + layoutOptions.xlfUrl;\r\n        fetchOptions.mode = 'no-cors';\r\n    } else if (layoutOptions.platform === 'chromeOS') {\r\n        xlfUrl = layoutOptions.xlfUrl;\r\n        fetchOptions.mode = 'cors';\r\n        fetchOptions.headers = {\r\n            'Content-Type': 'text/xml',\r\n        };\r\n    } else if (layoutOptions.platform !== 'CMS' && layoutOptions.appHost !== null) {\r\n        xlfUrl = layoutOptions.appHost + layoutOptions.xlfUrl;\r\n    }\r\n\r\n    const res = await fetch(xlfUrl);\r\n\r\n    return await res.text();\r\n}\r\n\r\nexport function handleAxiosError(error: any, message?: string) {\r\n    console.error(error);\r\n    if (error.response.status == 500) {\r\n        // SOAP responses are always 500's\r\n        // Return the body\r\n        throw new Error(error.response.data);\r\n    } else {\r\n        throw new Error(message || 'Unknown Error');\r\n    }\r\n}\r\n\r\nexport function getLayout(params: GetLayoutParamType): GetLayoutType {\r\n    let _currentLayout = undefined;\r\n    let _nextLayout = undefined;\r\n    let {\r\n        inputLayouts,\r\n        currentLayout,\r\n        nextLayout,\r\n        currentLayoutIndex: currLayoutIndx\r\n    } = params.xlr;\r\n    const hasLayout = inputLayouts.length > 0;\r\n    let currentLayoutIndex = currLayoutIndx;\r\n    let nextLayoutIndex = currentLayoutIndex + 1;\r\n\r\n    if (currentLayout === undefined && nextLayout === undefined) {\r\n        let activeLayout;\r\n        // Preview just got started\r\n        if (hasLayout) {\r\n            let nextLayoutTemp = {...initialLayout};\r\n            activeLayout = inputLayouts[currentLayoutIndex];\r\n            _currentLayout = {...initialLayout, ...activeLayout};\r\n\r\n            if (inputLayouts.length > 1) {\r\n                nextLayoutTemp = {...nextLayoutTemp, ...inputLayouts[nextLayoutIndex]};\r\n                _nextLayout = nextLayoutTemp;\r\n            } else {\r\n                _nextLayout = _currentLayout;\r\n            }\r\n\r\n            _currentLayout.id = activeLayout.layoutId;\r\n\r\n            if (nextLayoutTemp) {\r\n                _nextLayout.id = nextLayoutTemp.layoutId;\r\n            }\r\n        }\r\n    } else {\r\n        if (hasLayout) {\r\n            _currentLayout = nextLayout;\r\n\r\n            currentLayoutIndex = getIndexByLayoutId(inputLayouts, _currentLayout?.layoutId).index as number;\r\n            nextLayoutIndex = currentLayoutIndex + 1;\r\n\r\n            if (inputLayouts.length > 1 && nextLayoutIndex < inputLayouts.length) {\r\n                if (Boolean(params.xlr.layouts[nextLayoutIndex])) {\r\n                    _nextLayout = params.xlr.layouts[nextLayoutIndex];\r\n                } else {\r\n                    _nextLayout = {...initialLayout, ...inputLayouts[nextLayoutIndex]};\r\n                }\r\n            }\r\n\r\n            // If _nextLayout is undefined, then we go back to first layout\r\n            if (_nextLayout === undefined) {\r\n                _nextLayout = params.xlr.layouts[0];\r\n            }\r\n        }\r\n    }\r\n\r\n    return {\r\n        currentLayoutIndex,\r\n        inputLayouts: params.xlr.inputLayouts,\r\n        current: _currentLayout,\r\n        next: _nextLayout,\r\n    }\r\n}\r\n\r\nexport interface ILayoutEvents {\r\n    start: (layout: ILayout) => void;\r\n    end: (layout: ILayout) => void;\r\n}\r\n\r\nexport default function Layout(\r\n    data: Document | null,\r\n    options: OptionsType,\r\n    xlr: IXlr,\r\n    layout?: ILayout\r\n) {\r\n    const props = {\r\n        data: data,\r\n        options: options,\r\n        layout: layout || initialLayout,\r\n    }\r\n    const emitter = createNanoEvents<ILayoutEvents>();\r\n\r\n    emitter.on('start', (layout) => {\r\n        layout.done = false;\r\n        console.debug('Layout start emitted > Layout ID > ', layout.id);\r\n    });\r\n\r\n    emitter.on('end', (layout) => {\r\n        console.debug('Ending layout with ID of > ', layout.layoutId);\r\n        layout.done = true;\r\n        /* Remove layout that has ended */\r\n        const $layout = document.getElementById(layout.containerName);\r\n\r\n        console.debug({$layout});\r\n\r\n        if ($layout !== null) {\r\n            $layout.remove();\r\n        }\r\n\r\n        if (xlr.config.platform !== 'CMS') {\r\n            // Transition next layout to current layout and prepare next layout if exist\r\n            xlr.prepareLayouts().then((parent) => {\r\n                xlr.playSchedules(parent);\r\n            });\r\n        }\r\n    });\r\n\r\n    const layoutObject: ILayout = {\r\n        ...props.layout,\r\n        options: props.options,\r\n        emitter,\r\n    };\r\n\r\n    layoutObject.on = function<E extends keyof ILayoutEvents>(event: E, callback: ILayoutEvents[E]) {\r\n        return emitter.on(event, callback);\r\n    };\r\n    layoutObject.run = function() {\r\n        const layout = layoutObject;\r\n        const $layoutContainer = document.getElementById(`${layout.containerName}`);\r\n        const $splashScreen = document.getElementById(`splash_${layout.id}`);\r\n\r\n        if ($layoutContainer) {\r\n            $layoutContainer.style.display = 'block';\r\n        }\r\n\r\n        if ($splashScreen) {\r\n            $splashScreen.style.display = 'none';\r\n        }\r\n\r\n        console.debug('Layout running > Layout ID > ', layout.id);\r\n        console.debug('Layout Regions > ', layout.regions);\r\n        for (let i = 0; i < layout.regions.length; i++) {\r\n            // playLog(4, \"debug\", \"Running region \" + self.regions[i].id, false);\r\n            layout.regions[i].run();\r\n        }\r\n    };\r\n\r\n    layoutObject.parseXlf = function() {\r\n        const layout = layoutObject;\r\n        const {data, options} = props;\r\n        layout.containerName = \"L\" + layout.id + \"-\" + nextId(options);\r\n        layout.regions = [];\r\n\r\n        /* Create a hidden div to show the layout in */\r\n        let $layout = document.getElementById(layout.containerName);\r\n\r\n        if ($layout === null) {\r\n            $layout = document.createElement('div');\r\n            $layout.id = layout.containerName;\r\n        }\r\n\r\n        let $screen = document.getElementById('screen_container');\r\n        ($screen) && $screen.appendChild($layout);\r\n\r\n        if ($layout) {\r\n            $layout.style.display = 'none';\r\n            $layout.style.outline = 'red solid thin';\r\n        }\r\n\r\n        layout.layoutNode = data;\r\n\r\n        /* Calculate the screen size */\r\n        layout.sw = $screen?.offsetWidth || 0;\r\n        layout.sh = $screen?.offsetHeight || 0;\r\n\r\n        layout.xw = Number(layout.layoutNode?.firstElementChild?.getAttribute('width'));\r\n        layout.xh = Number(layout.layoutNode?.firstElementChild?.getAttribute('height'));\r\n        layout.zIndex = Number(layout.layoutNode?.firstElementChild?.getAttribute('zindex')) || 0;\r\n\r\n        /* Calculate Scale Factor */\r\n        layout.scaleFactor = Math.min((layout.sw / layout.xw), (layout.sh / layout.xh));\r\n        layout.sWidth = Math.round(layout.xw * layout.scaleFactor);\r\n        layout.sHeight = Math.round(layout.xh * layout.scaleFactor);\r\n        layout.offsetX = Math.abs(layout.sw - layout.sWidth) / 2;\r\n        layout.offsetY = Math.abs(layout.sh - layout.sHeight) / 2;\r\n\r\n        /* Scale the Layout Container */\r\n        if ($layout) {\r\n            $layout.style.width = `${layout.sWidth}px`;\r\n            $layout.style.height = `${layout.sHeight}px`;\r\n            $layout.style.position = 'absolute';\r\n            $layout.style.left = `${layout.offsetX}px`;\r\n            $layout.style.top = `${layout.offsetY}px`;\r\n        }\r\n\r\n        if ($layout && layout.zIndex !== null) {\r\n            $layout.style.zIndex = `${layout.zIndex}`;\r\n        }\r\n\r\n        /* Set the layout background */\r\n        layout.bgColor = layout.layoutNode?.firstElementChild?.getAttribute('bgcolor') || '';\r\n        layout.bgImage = layout.layoutNode?.firstElementChild?.getAttribute('background') || '';\r\n\r\n        if (!(layout.bgImage === \"\" || typeof layout.bgImage === 'undefined')) {\r\n            /* Extract the image ID from the filename */\r\n            layout.bgId = layout.bgImage.substring(0, layout.bgImage.indexOf('.'));\r\n\r\n            const bgImageUrl = composeBgUrlByPlatform(\r\n                xlr.config.platform,\r\n                {\r\n                    ...options,\r\n                    layout,\r\n                }\r\n            );\r\n\r\n            if ($layout) {\r\n                $layout.style.backgroundImage = `url(\"${bgImageUrl}\")`;\r\n                $layout.style.backgroundRepeat = 'no-repeat';\r\n                $layout.style.backgroundSize = `${layout.sWidth}px ${layout.sHeight}px`;\r\n                $layout.style.backgroundPosition = '0px 0px';\r\n            }\r\n        }\r\n\r\n        // Set the background color\r\n        if ($layout && layout.bgColor) {\r\n            $layout.style.backgroundColor = `${layout.bgColor}`;\r\n        }\r\n\r\n        // Hide if layout is not the currentLayout\r\n        if ($layout && xlr.currentLayoutId !== undefined && xlr.currentLayoutId !== layout.id) {\r\n            $layout.style.display = 'none';\r\n        }\r\n\r\n        // Create regions\r\n        const layoutRegions = Array.from(layout?.layoutNode?.getElementsByTagName('region') || []);\r\n\r\n        Array.from(layoutRegions).forEach((regionXml, indx) => {\r\n            const regionObj = Region(\r\n                layout,\r\n                regionXml,\r\n                regionXml?.getAttribute('id') || '',\r\n                options,\r\n                xlr,\r\n            );\r\n\r\n            regionObj.index = indx;\r\n            layout.regions.push(regionObj);\r\n        });\r\n    };\r\n\r\n    layoutObject.prepareLayout = function() {\r\n        layoutObject.parseXlf();\r\n    };\r\n\r\n    layoutObject.regionExpired = function() {\r\n        const self = layoutObject;\r\n        self.allExpired = true;\r\n\r\n        for (let layoutRegion of self.regions) {\r\n            if (!layoutRegion.complete) {\r\n                self.allExpired = false;\r\n            }\r\n        }\r\n\r\n        if (self.allExpired) {\r\n            self.end();\r\n        }\r\n    };\r\n\r\n    layoutObject.regionEnded = function() {\r\n        const self = layoutObject;\r\n        self.allEnded = true;\r\n        \r\n        for (var i = 0; i < self.regions.length; i++) {\r\n            if (! self.regions[i].ended) {\r\n                self.allEnded = false;\r\n            }\r\n        }\r\n        \r\n        if (self.allEnded) {\r\n            self.stopAllMedia().then(() => {\r\n                console.debug('starting to end layout . . .');\r\n                if (xlr.config.platform === 'CMS') {\r\n                    const $end = document.getElementById('play_ended');\r\n                    const $preview = document.getElementById('screen_container');\r\n        \r\n                    if ($preview) {\r\n                        while($preview.firstChild) {\r\n                            $preview.removeChild($preview.firstChild);\r\n                        }\r\n        \r\n                        $preview.style.display = 'none';\r\n                    }\r\n        \r\n                    if ($end) {\r\n                        $end.style.display = 'block';\r\n                    }\r\n                }\r\n                \r\n                self.emitter?.emit('end', self);\r\n            });\r\n\r\n        }\r\n    };\r\n\r\n    layoutObject.end = function() {\r\n        console.debug('Executing Layout::end and Calling Region::end ', layoutObject);\r\n\r\n        /* Ask the layout to gracefully stop running now */\r\n        for (let layoutRegion of layoutObject.regions) {\r\n            layoutRegion.end();\r\n        }\r\n    };\r\n\r\n    layoutObject.stopAllMedia = function() {\r\n        console.debug('Stopping all media . . .');\r\n        return new Promise(async (resolve) => {\r\n            for(var i = 0;i < layoutObject.regions.length;i++) {\r\n                var region = layoutObject.regions[i];\r\n                for(var j = 0;j < region.mediaObjects.length;j++) {\r\n                    var media = region.mediaObjects[j];\r\n                    await media.stop();\r\n                }\r\n            }\r\n\r\n            resolve();\r\n        });\r\n    };\r\n\r\n    layoutObject.prepareLayout();\r\n\r\n    return layoutObject;\r\n}\r\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport {ILayout, InputLayoutType, OptionsType} from '../Layout';\r\nimport {platform} from '../../Modules/Platform';\r\n\r\nexport type PrepareLayoutsType = {\r\n    moveNext?: boolean;\r\n};\r\n\r\nexport enum ELayoutType {\r\n    CURRENT,\r\n    NEXT,\r\n}\r\n\r\nexport interface IXlr {\r\n    inputLayouts: InputLayoutType[],\r\n    config: OptionsType,\r\n    layouts: ILayout[],\r\n    currentLayoutIndex: number;\r\n    currentLayoutId: number | null;\r\n    currentLayout: ILayout | undefined;\r\n    nextLayout: ILayout | undefined;\r\n    bootstrap(): void;\r\n    init(): Promise<IXlr>;\r\n    playSchedules(xlr: IXlr): void;\r\n    prepareLayoutXlf(inputLayout: ILayout | undefined): Promise<ILayout>;\r\n    prepareLayouts(): Promise<IXlr>;\r\n    updateLayouts(inputLayouts: InputLayoutType[]): void;\r\n}\r\n\r\nexport const initialXlr: IXlr = {\r\n    inputLayouts: [],\r\n    config: platform,\r\n    layouts: [],\r\n    currentLayoutIndex: 0,\r\n    currentLayoutId: null,\r\n    currentLayout: undefined,\r\n    nextLayout: undefined,\r\n    bootstrap() {\r\n    },\r\n    init() {\r\n        return Promise.resolve(<IXlr>{});\r\n    },\r\n    playSchedules() {\r\n    },\r\n    prepareLayoutXlf(inputLayout: ILayout | undefined): Promise<ILayout> {\r\n        return Promise.resolve(<ILayout>{});\r\n    },\r\n    prepareLayouts(): Promise<IXlr> {\r\n        return Promise.resolve(<IXlr>{});\r\n    },\r\n    updateLayouts(inputLayouts: InputLayoutType[]) {\r\n    }\r\n};\r\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport './splash-screen.css';\r\nimport xiboLogoImg from './img/logo.png';\r\nimport loaderImg from './img/loader.gif';\r\nimport {OptionsType} from '../../Types/Layout';\r\n\r\nexport interface ISplashScreen {\r\n    init: () => void;\r\n    show: () => void;\r\n    hide: () => void;\r\n}\r\n\r\nexport interface PreviewSplashElement extends HTMLDivElement {\r\n    hide: () => void;\r\n}\r\n\r\nexport default function SplashScreen($parent: Element | null, config?: OptionsType): ISplashScreen {\r\n    const $previewSplash = document.createElement('div') as PreviewSplashElement;\r\n    const $previewLoader = document.createElement('div');\r\n    const $previewLoaderCaption = document.createElement('div');\r\n    const $defaultNoLayout = document.createElement('div');\r\n\r\n     const splashScreenObj = {\r\n         init() {\r\n             $previewSplash.classList.add('preview-splash');\r\n\r\n             // Don't show Xibo logo on CMS Preview\r\n             if (config && config.platform !== 'CMS') {\r\n                 $previewSplash.style.setProperty(\r\n                     'background-image',\r\n                     `url(${xiboLogoImg})`,\r\n                 );\r\n                 $previewSplash.style.setProperty(\r\n                     'background-size',\r\n                     '200px 120px',\r\n                 );\r\n                 $previewSplash.style.setProperty(\r\n                     'background-position',\r\n                     'bottom right',\r\n                 );\r\n             }\r\n\r\n             $previewSplash.constructor.prototype.hide = () => {\r\n                 this.hide();\r\n             };\r\n\r\n             $previewLoader.classList.add('preview-loader');\r\n             $previewLoaderCaption.classList.add('preview-loaderCaption');\r\n\r\n             // Show loader bar and text on CMS Preview\r\n             if (config && config.platform === 'CMS') {\r\n                 $previewLoader.style.setProperty(\r\n                     'background-image',\r\n                     `url(${loaderImg})`,\r\n                 );\r\n                 $previewLoaderCaption.innerHTML = '<p>Loading Layout...</p>';\r\n             }\r\n\r\n             $previewSplash.insertBefore($previewLoader, $previewSplash.lastElementChild);\r\n             $previewSplash.insertBefore($previewLoaderCaption, null);\r\n\r\n             this.hide();\r\n         },\r\n         show() {\r\n             if ($parent) {\r\n                 $parent.insertBefore($previewSplash, $parent.firstElementChild);\r\n                 $previewSplash.style.setProperty('display', 'block');\r\n             }\r\n         },\r\n         hide() {\r\n             $previewSplash.style.setProperty('display', 'none');\r\n         },\r\n    };\r\n\r\n     splashScreenObj.init();\r\n\r\n     return splashScreenObj;\r\n}\r\n","/*\r\n * Copyright (C) 2024 Xibo Signage Ltd\r\n *\r\n * Xibo - Digital Signage - https://www.xibosignage.com\r\n *\r\n * This file is part of Xibo.\r\n *\r\n * Xibo is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * any later version.\r\n *\r\n * Xibo is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with Xibo.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport {\r\n    Layout, getLayout, getXlf, initRenderingDOM\r\n} from './Modules/Layout';\r\nimport { platform } from './Modules/Platform';\r\nimport {\r\n    ILayout, initialLayout, InputLayoutType, OptionsType,\r\n} from './Types/Layout';\r\nimport { initialXlr, IXlr } from './Types/XLR';\r\nimport {SplashScreen, ISplashScreen} from './Modules/SplashScreen';\r\n\r\nexport default function XiboLayoutRenderer(\r\n    inputLayouts: InputLayoutType[],\r\n    options?: OptionsType,\r\n) {\r\n    const props = {\r\n        inputLayouts,\r\n        options,\r\n    }\r\n\r\n    const xlrObject: IXlr = {\r\n        ...initialXlr,\r\n        bootstrap() {\r\n            // Place to set configurations and initialize required props\r\n            const self = this;\r\n            self.inputLayouts = !Array.isArray(props.inputLayouts) ?\r\n                [props.inputLayouts] : props.inputLayouts;\r\n            self.config = JSON.parse(JSON.stringify({...platform, ...props.options}));\r\n\r\n            // Prepare rendering DOM\r\n            const previewCanvas = document.querySelector('.preview-canvas');\r\n\r\n            initRenderingDOM(previewCanvas);\r\n\r\n            // Prepare splash screen\r\n            const splashScreen = SplashScreen(document.querySelector('.player-preview'));\r\n\r\n            splashScreen.show();\r\n\r\n        },\r\n        init() {\r\n            return new Promise<IXlr>((resolve) => {\r\n                const self = this;\r\n\r\n                self.prepareLayouts().then((xlr) => {\r\n                    resolve(xlr);\r\n                });\r\n            });\r\n        },\r\n\r\n        playSchedules(xlr: IXlr) {\r\n            // Check if there's a current layout\r\n            if (xlr.currentLayout !== undefined) {\r\n                xlr.currentLayout.emitter?.emit('start', xlr.currentLayout);\r\n                xlr.currentLayout.run();\r\n            }\r\n        },\r\n\r\n        updateLayouts(inputLayouts: InputLayoutType[]) {\r\n            /**\r\n             * @TODO\r\n             * Case 1: If currentLayout in inputLayouts and in the same sequence,\r\n             * Then, continue playing currentLayout.\r\n             * Check nextLayout in inputLayouts. If in inputLayouts and same sequence, then don't change.\r\n             * If not in inputLayouts, then replace and prepare nextLayout.\r\n             *\r\n             * Case 2: If currentLayout in inputLayouts but not in the same sequence,\r\n             * Then, replace loop, prepare layouts and start currentLayout\r\n             *\r\n             * Case 3: If currentLayout not in inputLayouts,\r\n             * Then, replace everything and start from first layout in sequence.\r\n             */\r\n            const self = this;\r\n\r\n            self.inputLayouts = inputLayouts;\r\n\r\n            const xlrLayouts = getLayout({xlr: self});\r\n\r\n            console.log({xlrLayouts});\r\n        },\r\n\r\n        async prepareLayouts() {\r\n            const self = this;\r\n            // Get layouts\r\n            const xlrLayouts = getLayout({xlr: self});\r\n\r\n            self.currentLayoutId = xlrLayouts.current?.layoutId as ILayout['layoutId'];\r\n\r\n            const layoutsXlf = () => {\r\n                let xlf = [];\r\n\r\n                xlf.push(xlrLayouts.current);\r\n\r\n                if (xlrLayouts.current?.layoutId !== xlrLayouts.next?.layoutId) {\r\n                    xlf.push(xlrLayouts.next);\r\n                }\r\n\r\n                return xlf.reduce((coll: Promise<ILayout>[], item) => {\r\n                    return [\r\n                        ...coll,\r\n                        self.prepareLayoutXlf(item),\r\n                    ];\r\n                }, []);\r\n            };\r\n            const layouts = await Promise.all<Array<Promise<ILayout>>>(layoutsXlf());\r\n\r\n            return new Promise<IXlr>((resolve) => {\r\n                self.layouts = layouts;\r\n                self.currentLayout = self.layouts[0];\r\n\r\n                if (Boolean(self.layouts[1])) {\r\n                    self.nextLayout = self.layouts[1];\r\n                } else {\r\n                    // Use current layout as next layout if only one layout is available\r\n                    self.nextLayout = self.layouts[0];\r\n                }\r\n\r\n                self.currentLayoutIndex = xlrLayouts.currentLayoutIndex;\r\n                self.layouts[self.currentLayoutIndex] = self.currentLayout;\r\n\r\n                resolve(self);\r\n            });\r\n        },\r\n\r\n        async prepareLayoutXlf(inputLayout: ILayout) {\r\n            const self = this;\r\n            // Compose layout props first\r\n            let newOptions: OptionsType = Object.assign({}, platform);\r\n\r\n            newOptions = {\r\n                ...newOptions,\r\n                ...props.options,\r\n            };\r\n\r\n            if (self.config.platform ==='CMS' &&\r\n                inputLayout && Boolean(inputLayout.layoutId)\r\n            ) {\r\n                newOptions.xlfUrl =\r\n                    newOptions.xlfUrl.replace(':layoutId', String(inputLayout.layoutId));\r\n            } else if (self.config.platform === 'chromeOS') {\r\n                newOptions.xlfUrl = inputLayout.path as string;\r\n            }\r\n\r\n            let layoutXlf: string;\r\n            let layoutXlfNode: Document | null;\r\n            if (inputLayout && inputLayout.layoutNode === null) {\r\n                layoutXlf = await getXlf(newOptions);\r\n\r\n                const parser = new window.DOMParser();\r\n                layoutXlfNode = parser.parseFromString(layoutXlf as string, 'text/xml');\r\n            } else {\r\n                layoutXlfNode = inputLayout && inputLayout.layoutNode;\r\n            }\r\n\r\n            return new Promise<ILayout>((resolve) => {\r\n                const xlrLayoutObj = initialLayout;\r\n                \r\n                xlrLayoutObj.id = Number(inputLayout.layoutId);\r\n                xlrLayoutObj.layoutId = Number(inputLayout.layoutId);\r\n                xlrLayoutObj.options = newOptions;\r\n\r\n                resolve(Layout(layoutXlfNode, newOptions, self, xlrLayoutObj));\r\n            });\r\n        },\r\n    }\r\n\r\n    xlrObject.bootstrap();\r\n\r\n    return xlrObject;\r\n}\r\n"],"names":["createNanoEvents","emit","event","_len","arguments","length","args","Array","_key","i","callbacks","events","apply","on","cb","_this$events","_this","push","_this$events$event","filter","RESOURCE_URL","XLF_URL","LAYOUT_BACKGROUND_DOWNLOAD_URL","LAYOUT_PREVIEW_URL","LIBRARY_DOWNLOAD_URL","LOADER_URL","platform","getResourceUrl","xlfUrl","layoutBackgroundDownloadUrl","layoutPreviewUrl","libraryDownloadUrl","loaderUrl","idCounter","inPreview","appHost","initialLayout","id","layoutId","sw","sh","xw","xh","zIndex","scaleFactor","sWidth","sHeight","offsetX","offsetY","bgColor","bgImage","bgId","containerName","layoutNode","regionMaxZIndex","ready","regionObjects","drawer","allExpired","regions","actions","options","done","allEnded","path","prepareLayout","parseXlf","run","callback","regionExpired","end","regionEnded","stopAllMedia","Promise","resolve","nextId","getMediaId","_ref","mediaType","mediaId","capitalizeStr","inputStr","String","charAt","toUpperCase","substring","getDataBlob","_x","_getDataBlob","_asyncToGenerator","_regeneratorRuntime","mark","_callee","src","wrap","_callee$","_context","prev","next","abrupt","fetch","mode","then","res","blob","rej","reader","FileReader","onloadend","result","onerror","readAsDataURL","stop","preloadMediaBlob","_x2","_x3","_preloadMediaBlob","_callee2","type","data","_callee2$","_context2","sent","Blob","arrayBuffer","audioFileType","getFileExt","URL","createObjectURL","fetchJSON","_x4","_fetchJSON","_callee3","url","_callee3$","_context3","json","err","console","debug","filename","filenameArr","split","str","validAudioTypes","Boolean","undefined","composeResourceUrlByPlatform","params","resourceUrl","regionOptions","replace","regionId","cmsUrl","fileId","uri","composeBgUrlByPlatform","bgImageUrl","layout","getIndexByLayoutId","layoutsInput","layoutIndexes","reduce","a","b","indx","Number","_objectSpread","index","initialRegion","xml","mediaObjects","mediaObjectsActions","currentMedia","complete","ending","ended","oneMedia","oldMedia","curMedia","nxtMedia","currentMediaIndex","totalMediaObjects","prepareRegion","playNextMedia","transitionNodes","finished","exitTransition","exitTransitionComplete","prepareMediaObjects","initialMedia","region","html","iframe","iframeName","render","attachedAudio","singlePlay","timeoutId","setTimeout","checkIframeStatus","loadIframeOnRun","tempSrc","schemaVersion","duration","useDuration","divWidth","divHeight","loop","init","defaultTrans","trans","defaultKeyframes","display","defaultTiming","keyframes","timing","fadeInElem","fadeInKeyframes","opacity","fadeInTiming","fill","fadeOutElem","fadeOutKeyframes","fadeOutTiming","flyInElem","keyframeOptions","direction","flyInKeyframes","flyInTiming","from","to","flyOutElem","flyOutKeyframes","flyOutTiming","transitionElement","transition","transitions","fadeIn","fadeOut","flyIn","flyOut","defaultIn","defaultOut","flyTransitionKeyframes","opacityAttr","source","top","concat","height","left","width","VideoMedia","media","videoMediaObject","$videoMedia","document","getElementById","onloadstart","onloadeddata","readyState","oncanplay","videoPlayPromise","play","error","muted","onplaying","ondurationchange","onended","_media$emitter","emitter","AudioMedia","audioMediaObject","$audioMedia","$playBtn","remove","audioPlayPromise","name","_$audioMedia$parentNo","createElement","classList","add","textContent","addEventListener","parentNode","insertBefore","nextSibling","Media","xlr","props","mediaTimer","mediaTimeCount","mediaObject","startMediaTimer","setInterval","$splashScreen","querySelector","style","hide","clearInterval","_self$xml","_self$xml2","_self$xml3","_self$xml4","_self$xml5","self","getAttribute","parseInt","$mediaIframe","mediaOptions","getElementsByTagName","_i","_Array$from","_options","_mediaOptions","children","_i2","_Array$from2","mediaOption","nodeName","toLowerCase","showfullscreen","scrolling","cssText","$mediaId","$media","Audio","className","resourceUrlParams","config","tmpUrl","align","valign","preload","mute","scaletype","objectFit","playsInline","autoplay","regex","RegExp","exec","transInDuration","transinduration","fadeInTrans","animate","transInDirection","transindirection","defaultTransInOptions","transIn","transInName","showCurrentMedia","_ref2","isCMS","_self$emitter","getNewMedia","setProperty","t0","t1","t2","t3","t4","call","t5","t6","innerHTML","appendChild","iframeStyles","$region","lastElementChild","Region","regionObject","_self$xml6","_regionOptions","regionOption","$layout","Math","round","regionMediaItems","forEach","mediaXml","mediaObj","nextMediaIndex","newMedia","transOutDuration","transOutDirection","transoutduration","transoutdirection","defaultTransOutOptions","transOut","transOutName","hideOldMedia","$oldMedia","removeOldMedia","oldMediaAnimate","_oldMediaAnimate","effect","updateTiming","isDone","_self$curMedia","_self$curMedia2","_self$curMedia3","_self$curMedia4","playAgainClickHandle","ev","preventDefault","history","go","initRenderingDOM","targetContainer","_targetContainer","previewPlayer","previewScreen","endPlay","playAgainLink","removeEventListener","body","firstChild","getXlf","_getXlf","layoutOptions","apiHost","fetchOptions","window","location","origin","headers","text","getLayout","_currentLayout","_nextLayout","_params$xlr","inputLayouts","currentLayout","nextLayout","currLayoutIndx","currentLayoutIndex","hasLayout","nextLayoutIndex","activeLayout","nextLayoutTemp","_currentLayout2","layouts","current","Layout","prepareLayouts","parent","playSchedules","layoutObject","$layoutContainer","_layout$layoutNode","_layout$layoutNode2","_layout$layoutNode3","_layout$layoutNode4","_layout$layoutNode5","_layout$layoutNode6","$screen","outline","offsetWidth","offsetHeight","firstElementChild","min","abs","position","indexOf","backgroundImage","backgroundRepeat","backgroundSize","backgroundPosition","backgroundColor","currentLayoutId","layoutRegions","regionXml","regionObj","_iterator","_createForOfIteratorHelper","_step","s","n","layoutRegion","value","e","f","$end","$preview","removeChild","_iterator2","_step2","j","ELayoutType","initialXlr","bootstrap","prepareLayoutXlf","inputLayout","updateLayouts","SplashScreen","$parent","$previewSplash","$previewLoader","$previewLoaderCaption","splashScreenObj","constructor","prototype","show","XiboLayoutRenderer","xlrObject","isArray","JSON","parse","stringify","previewCanvas","splashScreen","_xlr$currentLayout$em","xlrLayouts","log","_this2","_xlrLayouts$current","layoutsXlf","_xlrLayouts$current2","_xlrLayouts$next","xlf","coll","item","_toConsumableArray","all","_this3","newOptions","layoutXlf","layoutXlfNode","parser","Object","assign","DOMParser","parseFromString","xlrLayoutObj"],"mappings":"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","x_google_ignoreList":[0]}